function openUploader(n,t){var r="~/albums/"+n+"/"+t,i;$("#upload-photo-dialog").dialog("open");i=[];uploader.init({subpath:r,size:"5mb",container:"upload-photo-dialog",ext:"img",success:function(u,f){for(var o,e=0;e<f.length;e++)f[e].status==plupload.DONE&&(o={AccountName:n,AlbumID:t,FileName:f[e].target_name,Title:f[e].name,Type:0},i.push(o));savePhoto(i,r)}});uploader.show()}function myFileBrowser(){tinymce.activeEditor.windowManager.close();openUploader(AccountName,0)}function savePhoto(n,t){$.ajax({type:"POST",url:"/AlbumMgmt/Photo/Add",data:JSON.stringify(n),contentType:"application/json",success:function(){$("#upload-photo-dialog").dialog("close");ImageSrcToAdd=t.substring(1)+"/"+n[0].FileName;tinymce.activeEditor.execCommand("mceImageWindow")}})}function deletePhoto(n){$.ajax({type:"POST",url:"/AlbumMgmt/Photo/Delete",data:{photoID:n},success:function(){location.reload()}})}var uploader={subpath:"",resizeSet:0,resizeValue:0,validateWidth:0,validateHeight:0,validateScale:0,filters:[],size:"",container:"",multi_selection:!0,max_file_count:30,success:function(){},init:function(n){uploader.subpath=n.subpath;uploader.size=n.size;uploader.container="#"+n.container;uploader.success=n.success;uploader.resizeSet=n.resizeSet!=null?n.resizeSet:0;uploader.resizeValue=n.resizeValue!=null?n.resizeValue:0;uploader.validateWidth=n.validateWidth!=null?n.validateWidth:0;uploader.validateHeight=n.validateHeight!=null?n.validateHeight:0;uploader.validateScale=n.validateScale!=null?n.validateScale:0;n.multi_selection!=null&&(uploader.multi_selection=n.multi_selection);n.max_file_count&&(uploader.max_file_count=n.max_file_count);switch(n.ext){case"img":uploader.filters.push({title:"Image files",extensions:"jpg,gif,png,bmp,webp,jpeg"})}},show:function(){$(uploader.container).show();$(uploader.container).pluploadQueue({runtimes:"html5,html4,flash",url:"/File/Upload",max_file_size:uploader.size,max_files:uploader.max_file_count,unique_names:!0,multiple_queues:!1,filters:uploader.filters,multi_selection:uploader.multi_selection,multipart_params:{subpath:uploader.subpath,resizeSet:uploader.resizeSet,resizeValue:uploader.resizeValue,validateWidth:uploader.validateWidth,validateHeight:uploader.validateHeight,validateScale:uploader.validateScale},preinit:function(n){n.bind("FileUploaded",function(n,t,i){i.response!="ok"&&(alert("上傳時出現錯誤"),n.removeFile(t))});n.bind("UploadComplete",function(n,t){t.length!=0&&(uploader.success(n,t),alert("上傳成功"))});n.bind("FilesAdded",function(n,t){n.files.length+t.length>=n.settings.max_files&&(t.splice(n.settings.max_files),$(n.settings.browse_button).hide())});n.bind("FilesRemoved",function(n){n.files.length<n.settings.max_files&&$(n.settings.browse_button).show()});n.bind("Error",function(n,t){t.code==-200&&alert("上傳時出現錯誤，請檢查後重新上傳!")})}});var n=$(uploader.container).pluploadQueue();n.refresh()},hide:function(){$(uploader.container).parent().hide();uploader.destroy()}},ImageSrcToAdd;
/*
//# sourceMappingURL=uploader.min.js.map
*/