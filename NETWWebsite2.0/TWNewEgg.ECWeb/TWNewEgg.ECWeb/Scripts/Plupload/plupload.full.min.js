!function (bc, aU) { function a1(d, b) { for (var f, a = [], c = 0; c < d.length; ++c) { if (f = aV[d[c]] || a0(d[c]), !f) { throw "module definition dependecy not found: " + d[c] } a.push(f) } b.apply(null, a) } function a7(c, a, b) { if ("string" != typeof c) { throw "invalid module definition, module id must be defined and be a string" } if (a === aU) { throw "invalid module definition, dependencies must be specified" } if (b === aU) { throw "invalid module definition, definition function must be specified" } a1(a, function () { aV[c] = b.apply(null, arguments) }) } function aW(a) { return !!aV[a] } function a0(b) { for (var d = bc, a = b.split(/[.\/]/), c = 0; c < a.length; ++c) { if (!d[a[c]]) { return } d = d[a[c]] } return d } function bg(g) { for (var d = 0; d < g.length; d++) { for (var e = bc, f = g[d], b = f.split(/[.\/]/), c = 0; c < b.length - 1; ++c) { e[b[c]] === aU && (e[b[c]] = {}), e = e[b[c]] } e[b[b.length - 1]] = aV[f] } } var aV = {}, aT = "moxie/core/utils/Basic", be = "moxie/core/I18n", a3 = "moxie/core/utils/Mime", bd = "moxie/core/utils/Env", bb = "moxie/core/utils/Dom", aZ = "moxie/core/Exceptions", a8 = "moxie/core/EventTarget", a2 = "moxie/core/utils/Encode", a9 = "moxie/runtime/Runtime", aS = "moxie/runtime/RuntimeClient", aP = "moxie/file/Blob", aB = "moxie/file/File", bh = "moxie/file/FileInput", aj = "moxie/file/FileDrop", aR = "moxie/runtime/RuntimeTarget", aQ = "moxie/file/FileReader", bf = "moxie/core/utils/Url", aF = "moxie/file/FileReaderSync", ag = "moxie/xhr/FormData", ai = "moxie/xhr/XMLHttpRequest", an = "moxie/runtime/Transporter", aw = "moxie/core/JSON", aC = "moxie/image/Image", aq = "moxie/runtime/html5/Runtime", ao = "moxie/runtime/html5/file/Blob", ap = "moxie/core/utils/Events", aD = "moxie/runtime/html5/file/FileInput", aA = "moxie/runtime/html5/file/FileDrop", am = "moxie/runtime/html5/file/FileReader", ax = "moxie/runtime/html5/xhr/XMLHttpRequest", aE = "moxie/runtime/html5/utils/BinaryReader", af = "moxie/runtime/html5/image/JPEGHeaders", az = "moxie/runtime/html5/image/ExifParser", aO = "moxie/runtime/html5/image/JPEG", aX = "moxie/runtime/html5/image/PNG", a4 = "moxie/runtime/html5/image/ImageInfo", ac = "moxie/runtime/html5/image/MegaPixel", a6 = "moxie/runtime/html5/image/Image", ae = "moxie/runtime/flash/Runtime", ad = "moxie/runtime/flash/file/Blob", ab = "moxie/runtime/flash/file/FileInput", aN = "moxie/runtime/flash/file/FileReader", ar = "moxie/runtime/flash/file/FileReaderSync", aa = "moxie/runtime/flash/xhr/XMLHttpRequest", au = "moxie/runtime/flash/runtime/Transporter", al = "moxie/runtime/flash/image/Image", aY = "moxie/runtime/silverlight/Runtime", ba = "moxie/runtime/silverlight/file/Blob", a5 = "moxie/runtime/silverlight/file/FileInput", aI = "moxie/runtime/silverlight/file/FileDrop", aL = "moxie/runtime/silverlight/file/FileReader", aK = "moxie/runtime/silverlight/file/FileReaderSync", ah = "moxie/runtime/silverlight/xhr/XMLHttpRequest", ay = "moxie/runtime/silverlight/runtime/Transporter", aM = "moxie/runtime/silverlight/image/Image", aG = "moxie/runtime/html4/Runtime", aJ = "moxie/runtime/html4/file/FileInput", ak = "moxie/runtime/html4/file/FileReader", aH = "moxie/runtime/html4/xhr/XMLHttpRequest", av = "moxie/runtime/html4/image/Image"; a7(aT, [], function () { var k = function (c) { var a; return c === a ? "undefined" : null === c ? "null" : c.nodeType ? "node" : {}.toString.call(c).match(/\s([a-z|A-Z]+)/)[1].toLowerCase() }, w = function (a) { var c; return g(arguments, function (d, e) { e > 0 && g(d, function (l, i) { l !== c && (k(a[i]) === k(l) && ~f(k(l), ["array", "object"]) ? w(a[i], l) : a[i] = l) }) }), a }, g = function (u, l) { var z, d, s, y; if (u) { try { z = u.length } catch (c) { z = y } if (z === y) { for (d in u) { if (u.hasOwnProperty(d) && l(u[d], d) === !1) { return } } } else { for (s = 0; z > s; s++) { if (l(u[s], s) === !1) { return } } } } }, j = function (a) { var c; if (!a || "object" !== k(a)) { return !0 } for (c in a) { return !1 } return !0 }, b = function (c, l) { function a(i) { "function" === k(c[i]) && c[i](function (n) { ++i < e && !n ? a(i) : l(n) }) } var d = 0, e = c.length; "function" !== k(l) && (l = function () { }), c && c.length || l(), a(d) }, f = function (d, c) { if (c) { if (Array.prototype.indexOf) { return Array.prototype.indexOf.call(c, d) } for (var l = 0, a = c.length; a > l; l++) { if (c[l] === d) { return l } } } return -1 }, q = function (c, e) { var a = []; "array" !== k(c) && (c = [c]), "array" !== k(e) && (e = [e]); for (var d in c) { -1 === f(c[d], e) && a.push(c[d]) } return a.length ? a : !1 }, x = function (d, c) { var a = []; return g(d, function (i) { -1 !== f(i, c) && a.push(i) }), a.length ? a : null }, v = function (c) { var a, d = []; for (a = 0; a < c.length; a++) { d[a] = c[a] } return d }, p = function () { var a = 0; return function (d) { var e = (new Date).getTime().toString(32), c; for (c = 0; 5 > c; c++) { e += Math.floor(65535 * Math.random()).toString(32) } return (d || "o_") + e + (a++).toString(32) } }(), h = function (a) { return a ? String.prototype.trim ? String.prototype.trim.call(a) : a.toString().replace(/^\s*/, "").replace(/\s*$/, "") : a }, m = function (c) { if ("string" != typeof c) { return c } var a = { t: 1099511627776, g: 1073741824, m: 1048576, k: 1024 }, d; return c = /^([0-9]+)([mgk]?)$/.exec(c.toLowerCase().replace(/[^0-9mkg]/g, "")), d = c[2], c = +c[1], a.hasOwnProperty(d) && (c *= a[d]), c }; return { guid: p, typeOf: k, extend: w, each: g, isEmptyObj: j, inSeries: b, inArray: f, arrayDiff: q, arrayIntersect: x, toArray: v, trim: h, parseSizeStr: m } }), a7(be, [aT], function (b) { var a = {}; return { addI18n: function (c) { return b.extend(a, c) }, translate: function (c) { return a[c] || c }, _: function (c) { return this.translate(c) }, sprintf: function (d) { var e = [].slice.call(arguments, 1), c = ""; return b.each(d.split(/%[a-z]/), function (f) { c += f, e.length && (c += e.shift()) }), c } } }), a7(a3, [aT, be], function (c, b) { var d = "application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/mp4,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe", a = { mimes: {}, extensions: {}, addMimeType: function (j) { var g = j.split(/,/), k, f, h; for (k = 0; k < g.length; k += 2) { for (h = g[k + 1].split(/ /), f = 0; f < h.length; f++) { this.mimes[h[f]] = g[k] } this.extensions[g[k]] = h } }, extList2mimes: function (h, m) { var g = this, k, l, e, j, f = []; for (l = 0; l < h.length; l++) { for (k = h[l].extensions.split(/\s*,\s*/), e = 0; e < k.length; e++) { if ("*" === k[e]) { return [] } if (j = g.mimes[k[e]]) { -1 === c.inArray(j, f) && f.push(j) } else { if (!m || !/^\w+$/.test(k[e])) { return [] } f.push("." + k[e]) } } } return f }, mimes2exts: function (f) { var g = this, e = []; return c.each(f, function (h) { if ("*" === h) { return e = [], !1 } var i = h.match(/^(\w+)\/(\*|\w+)$/); i && ("*" === i[2] ? c.each(g.extensions, function (k, j) { new RegExp("^" + i[1] + "/").test(j) && [].push.apply(e, g.extensions[j]) }) : g.extensions[h] && [].push.apply(e, g.extensions[h])) }), e }, mimes2extList: function (g) { var e = [], f = []; return "string" === c.typeOf(g) && (g = c.trim(g).split(/\s*,\s*/)), f = this.mimes2exts(g), e.push({ title: b.translate("Files"), extensions: f.length ? f.join(",") : "*" }), e.mimes = g, e }, getFileExtension: function (g) { var f = g && g.match(/\.([^.]+)$/); return f ? f[1].toLowerCase() : "" }, getFileMime: function (f) { return this.mimes[this.getFileExtension(f)] || "" } }; return a.addMimeType(d), a }), a7(bd, [aT], function (h) { function d(m) { for (var l, o, a = 0; a < m.length; a++) { if (l = m[a].s1, o = m[a].prop, j = m[a].sv || m[a].id, l) { if (-1 != l.indexOf(m[a].s2)) { return m[a].id } } else { if (o) { return m[a].id } } } } function k(i) { var a = i.indexOf(j); if (-1 != a) { return parseFloat(i.substring(a + j.length + 1)) } } var c = [{ s1: navigator.userAgent, s2: "Android", id: "Android Browser", sv: "Version" }, { s1: navigator.userAgent, s2: "Chrome", id: "Chrome" }, { s1: navigator.vendor, s2: "Apple", id: "Safari", sv: "Version" }, { prop: window.opera && window.opera.buildNumber, id: "Opera", sv: "Version" }, { s1: navigator.vendor, s2: "KDE", id: "Konqueror" }, { s1: navigator.userAgent, s2: "Firefox", id: "Firefox" }, { s1: navigator.vendor, s2: "Camino", id: "Camino" }, { s1: navigator.userAgent, s2: "Netscape", id: "Netscape" }, { s1: navigator.userAgent, s2: "MSIE", id: "IE", sv: "MSIE" }, { s1: navigator.userAgent, s2: "Gecko", id: "Mozilla", sv: "rv" }], g = [{ s1: navigator.platform, s2: "Win", id: "Windows" }, { s1: navigator.platform, s2: "Mac", id: "Mac" }, { s1: navigator.userAgent, s2: "iPhone", id: "iOS" }, { s1: navigator.userAgent, s2: "iPad", id: "iOS" }, { s1: navigator.userAgent, s2: "Android", id: "Android" }, { s1: navigator.platform, s2: "Linux", id: "Linux" }], j, b = function () { var a = { define_property: function () { return !1 }(), create_canvas: function () { var i = document.createElement("canvas"); return !(!i.getContext || !i.getContext("2d")) }(), return_response_type: function (l) { try { if (-1 !== h.inArray(l, ["", "text", "document"])) { return !0 } if (window.XMLHttpRequest) { var m = new XMLHttpRequest; if (m.open("get", "/"), "responseType" in m) { return m.responseType = l, m.responseType !== l ? !1 : !0 } } } catch (e) { } return !1 }, use_data_uri: function () { var i = new Image; return i.onload = function () { a.use_data_uri = 1 === i.width && 1 === i.height }, setTimeout(function () { i.src = "data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" }, 1), !1 }(), use_data_uri_over32kb: function () { return a.use_data_uri && ("IE" !== f.browser || f.version >= 9) }, use_data_uri_of: function (i) { return a.use_data_uri && 33000 > i || a.use_data_uri_over32kb() }, use_fileinput: function () { var i = document.createElement("input"); return i.setAttribute("type", "file"), !i.disabled } }; return function (l) { var e = [].slice.call(arguments); return e.shift(), "function" === h.typeOf(a[l]) ? a[l].apply(this, e) : !!a[l] } }(), f = { can: b, browser: d(c), version: k(navigator.userAgent) || k(navigator.appVersion), OS: d(g), swf_url: "../flash/Moxie.swf", xap_url: "../silverlight/Moxie.xap", global_event_dispatcher: "moxie.core.EventTarget.instance.dispatchEvent" }; return f }), a7(bb, [bd], function (h) { var d = function (a) { return "string" != typeof a ? a : document.getElementById(a) }, k = function (i, a) { var l; return "" === i.className ? !1 : (l = new RegExp("(^|\\s+)" + a + "(\\s+|$)"), l.test(i.className)) }, c = function (i, a) { k(i, a) || (i.className = "" === i.className ? a : i.className.replace(/\s+$/, "") + " " + a) }, g = function (i, a) { var l = new RegExp("(^|\\s+)" + a + "(\\s+|$)"); i.className = i.className.replace(l, function (o, m, p) { return " " === m && " " === p ? " " : "" }) }, j = function (i, a) { return i.currentStyle ? i.currentStyle[a] : window.getComputedStyle ? window.getComputedStyle(i, null)[a] : void 0 }, b = function (x, m) { function p(u) { var o, z, a = 0, s = 0; return u && (z = u.getBoundingClientRect(), o = "CSS1Compat" === y.compatMode ? y.documentElement : y.body, a = z.left + o.scrollLeft, s = z.top + o.scrollTop), { x: a, y: s } } var e = 0, l = 0, v, y = document, w, q; if (x = x, m = m || y.body, x && x.getBoundingClientRect && "IE" === h.browser && (!y.documentMode || y.documentMode < 8)) { return w = p(x), q = p(m), { x: w.x - q.x, y: w.y - q.y } } for (v = x; v && v != m && v.nodeType;) { e += v.offsetLeft || 0, l += v.offsetTop || 0, v = v.offsetParent } for (v = x.parentNode; v && v != m && v.nodeType;) { e -= v.scrollLeft || 0, l -= v.scrollTop || 0, v = v.parentNode } return { x: e, y: l } }, f = function (a) { return { w: a.offsetWidth || a.clientWidth, h: a.offsetHeight || a.clientHeight } }; return { get: d, hasClass: k, addClass: c, removeClass: g, getStyle: j, getPos: b, getSize: f } }), a7(aZ, [aT], function (b) { function a(d, c) { var f; for (f in d) { if (d[f] === c) { return f } } return null } return { RuntimeError: function () { function d(f) { this.code = f, this.name = a(c, f), this.message = this.name + ": RuntimeError " + this.code } var c = { NOT_INIT_ERR: 1, NOT_SUPPORTED_ERR: 9, JS_ERR: 4 }; return b.extend(d, c), d.prototype = Error.prototype, d }(), OperationNotAllowedException: function () { function c(d) { this.code = d, this.name = "OperationNotAllowedException" } return b.extend(c, { NOT_ALLOWED_ERR: 1 }), c.prototype = Error.prototype, c }(), ImageError: function () { function d(f) { this.code = f, this.name = a(c, f), this.message = this.name + ": ImageError " + this.code } var c = { WRONG_FORMAT: 1, MAX_RESOLUTION_ERR: 2 }; return b.extend(d, c), d.prototype = Error.prototype, d }(), FileException: function () { function d(f) { this.code = f, this.name = a(c, f), this.message = this.name + ": FileException " + this.code } var c = { NOT_FOUND_ERR: 1, SECURITY_ERR: 2, ABORT_ERR: 3, NOT_READABLE_ERR: 4, ENCODING_ERR: 5, NO_MODIFICATION_ALLOWED_ERR: 6, INVALID_STATE_ERR: 7, SYNTAX_ERR: 8 }; return b.extend(d, c), d.prototype = Error.prototype, d }(), DOMException: function () { function d(f) { this.code = f, this.name = a(c, f), this.message = this.name + ": DOMException " + this.code } var c = { INDEX_SIZE_ERR: 1, DOMSTRING_SIZE_ERR: 2, HIERARCHY_REQUEST_ERR: 3, WRONG_DOCUMENT_ERR: 4, INVALID_CHARACTER_ERR: 5, NO_DATA_ALLOWED_ERR: 6, NO_MODIFICATION_ALLOWED_ERR: 7, NOT_FOUND_ERR: 8, NOT_SUPPORTED_ERR: 9, INUSE_ATTRIBUTE_ERR: 10, INVALID_STATE_ERR: 11, SYNTAX_ERR: 12, INVALID_MODIFICATION_ERR: 13, NAMESPACE_ERR: 14, INVALID_ACCESS_ERR: 15, VALIDATION_ERR: 16, TYPE_MISMATCH_ERR: 17, SECURITY_ERR: 18, NETWORK_ERR: 19, ABORT_ERR: 20, URL_MISMATCH_ERR: 21, QUOTA_EXCEEDED_ERR: 22, TIMEOUT_ERR: 23, INVALID_NODE_TYPE_ERR: 24, DATA_CLONE_ERR: 25 }; return b.extend(d, c), d.prototype = Error.prototype, d }(), EventException: function () { function c(d) { this.code = d, this.name = "EventException" } return b.extend(c, { UNSPECIFIED_EVENT_TYPE_ERR: 0 }), c.prototype = Error.prototype, c }() } }), a7(a8, [aZ, aT], function (b, a) { function c() { var d = {}; a.extend(this, { uid: null, init: function () { this.uid || (this.uid = a.guid("uid_")) }, addEventListener: function (k, g, j, l) { var f = this, h; return k = a.trim(k), /\s/.test(k) ? (a.each(k.split(/\s+/), function (i) { f.addEventListener(i, g, j, l) }), void 0) : (k = k.toLowerCase(), j = parseInt(j, 10) || 0, h = d[this.uid] && d[this.uid][k] || [], h.push({ fn: g, priority: j, scope: l || this }), d[this.uid] || (d[this.uid] = {}), d[this.uid][k] = h, void 0) }, hasEventListener: function (f) { return f ? !(!d[this.uid] || !d[this.uid][f]) : !!d[this.uid] }, removeEventListener: function (h, f) { h = h.toLowerCase(); var g = d[this.uid] && d[this.uid][h], j; if (g) { if (f) { for (j = g.length - 1; j >= 0; j--) { if (g[j].fn === f) { g.splice(j, 1); break } } } else { g = [] } g.length || (delete d[this.uid][h], a.isEmptyObj(d[this.uid]) && delete d[this.uid]) } }, removeAllEventListeners: function () { d[this.uid] && delete d[this.uid] }, dispatchEvent: function (g) { var j, k, e, h, f = {}; if ("string" !== a.typeOf(g)) { if (h = g, "string" !== a.typeOf(h.type)) { throw new b.EventException(b.EventException.UNSPECIFIED_EVENT_TYPE_ERR) } g = h.type, h.total && h.loaded && (f.total = h.total, f.loaded = h.loaded), f.async = h.async || !1 } if (-1 !== g.indexOf("::") ? function (i) { j = i[0], g = i[1] }(g.split("::")) : j = this.uid, g = g.toLowerCase(), k = d[j] && d[j][g]) { k.sort(function (m, i) { return i.priority - m.priority }), e = [].slice.call(arguments), e.shift(), f.type = g, e.unshift(f); var l = []; a.each(k, function (i) { e[0].target = i.scope, f.async ? l.push(function (m) { setTimeout(function () { m(i.fn.apply(i.scope, e) === !1) }, 1) }) : l.push(function (m) { m(i.fn.apply(i.scope, e) === !1) }) }), l.length && a.inSeries(l) } return !0 }, bind: function () { this.addEventListener.apply(this, arguments) }, unbind: function () { this.removeEventListener.apply(this, arguments) }, unbindAll: function () { this.removeAllEventListeners.apply(this, arguments) }, trigger: function () { this.dispatchEvent.apply(this, arguments) }, convertEventPropsToHandlers: function (g) { var h; "array" !== a.typeOf(g) && (g = [g]); for (var f = 0; f < g.length; f++) { h = "on" + g[f], "function" === a.typeOf(this[h]) ? this.addEventListener(g[f], this[h]) : "undefined" === a.typeOf(this[h]) && (this[h] = null) } } }) } return c.instance = new c, c }), a7(a2, [], function () { var c = function (f) { return unescape(encodeURIComponent(f)) }, b = function (f) { return decodeURIComponent(escape(f)) }, d = function (z, q) { if ("function" == typeof window.atob) { return q ? b(window.atob(z)) : window.atob(z) } var w = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", g, k, C, E, D, B, v, A, y = 0, j = 0, x = "", t = []; if (!z) { return z } z += ""; do { E = w.indexOf(z.charAt(y++)), D = w.indexOf(z.charAt(y++)), B = w.indexOf(z.charAt(y++)), v = w.indexOf(z.charAt(y++)), A = E << 18 | D << 12 | B << 6 | v, g = 255 & A >> 16, k = 255 & A >> 8, C = 255 & A, t[j++] = 64 == B ? String.fromCharCode(g) : 64 == v ? String.fromCharCode(g, k) : String.fromCharCode(g, k, C) } while (y < z.length); return x = t.join(""), q ? b(x) : x }, a = function (F, q) { if (q && c(F), "function" == typeof window.btoa) { return window.btoa(F) } var x = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", e, k, D, G, E, C, w, B, A = 0, j = 0, y = "", v = []; if (!F) { return F } do { e = F.charCodeAt(A++), k = F.charCodeAt(A++), D = F.charCodeAt(A++), B = e << 16 | k << 8 | D, G = 63 & B >> 18, E = 63 & B >> 12, C = 63 & B >> 6, w = 63 & B, v[j++] = x.charAt(G) + x.charAt(E) + x.charAt(C) + x.charAt(w) } while (A < F.length); y = v.join(""); var z = F.length % 3; return (z ? y.slice(0, z - 3) : y) + "===".slice(z || 3) }; return { utf8_encode: c, utf8_decode: b, atob: d, btoa: a } }), a7(a9, [aT, bb, a8], function (d, b, g) { function a(h, e, o, q, p) { function m(n, l) { var s = null, u = h && h.required_caps; return l = l || "browser", null !== this.mode ? this.mode : (u && !d.isEmptyObj(n) && (d.each(u, function (v, r) { if (n.hasOwnProperty(r)) { var t = n[r](v); if ("string" == typeof t && (t = [t]), s) { if (!(s = d.arrayIntersect(s, t))) { return s = !1 } } else { s = t } } }), s ? this.mode = -1 !== d.inArray(l, s) ? l : s[0] : s === !1 && (this.mode = !1)), null === this.mode && (this.mode = l), this.mode && u && !this.can(u) && (this.mode = !1), void 0) } var i = this, k, j = d.guid(e + "_"); f[j] = this, o = d.extend({ access_binary: !1, access_image_binary: !1, display_media: !1, do_cors: !1, drag_and_drop: !1, filter_by_extension: !0, resize_image: !1, report_upload_progress: !1, return_response_headers: !1, return_response_type: !1, return_status_code: !0, send_custom_headers: !1, select_file: !1, select_folder: !1, select_multiple: !0, send_binary_string: !1, send_browser_cookies: !0, send_multipart: !0, slice_blob: !1, stream_upload: !1, summon_file_dialog: !1, upload_filesize: !0, use_http_method: !0 }, o), k = function () { var l = {}; return { exec: function (u, v, s, t) { return k[v] && (l[u] || (l[u] = { context: this, instance: new k[v] }), l[u].instance[s]) ? l[u].instance[s].apply(this, t) : void 0 }, removeInstance: function (n) { delete l[n] }, removeAllInstances: function () { var r = this; d.each(l, function (s, n) { "function" === d.typeOf(s.instance.destroy) && s.instance.destroy.call(s.context), r.removeInstance(n) }) } } }(), d.extend(this, { initialized: !1, uid: j, type: e, mode: null, shimid: j + "_container", clients: 0, options: h, can: function (l, v) { var s = arguments[2] || o; if ("string" === d.typeOf(l) && "undefined" === d.typeOf(v) && (l = a.parseCaps(l)), "object" === d.typeOf(l)) { for (var u in l) { if (!this.can(u, l[u], s)) { return !1 } } return !0 } return "function" === d.typeOf(s[l]) ? s[l].call(this, v) : v === s[l] }, getShimContainer: function () { var r, l = b.get(this.shimid); return l || (r = this.options.container ? b.get(this.options.container) : document.body, l = document.createElement("div"), l.id = this.shimid, l.className = "moxie-shim moxie-shim-" + this.type, d.extend(l.style, { position: "absolute", top: "0px", left: "0px", width: "1px", height: "1px", overflow: "hidden" }), r.appendChild(l), r = null), l }, getShim: function () { return k }, shimExec: function (r, l) { var s = [].slice.call(arguments, 2); return i.getShim().exec.call(this, this.uid, r, l, s) }, exec: function (r, l) { var s = [].slice.call(arguments, 2); return i[r] && i[r][l] ? i[r][l].apply(this, s) : i.shimExec.apply(this, arguments) }, destroy: function () { if (i) { var l = b.get(this.shimid); l && l.parentNode.removeChild(l), k && k.removeAllInstances(), this.unbindAll(), delete f[this.uid], this.uid = null, j = i = k = l = null } } }), m.call(this, q, p) } var c = {}, f = {}; return a.order = "html5,flash,silverlight,html4", a.getRuntime = function (h) { return f[h] ? f[h] : !1 }, a.addConstructor = function (i, h) { h.prototype = g.instance, c[i] = h }, a.getConstructor = function (h) { return c[h] || null }, a.getInfo = function (i) { var h = a.getRuntime(i); return h ? { uid: h.uid, type: h.type, can: function () { return h.can.apply(h, arguments) } } : null }, a.parseCaps = function (e) { var h = {}; return "string" !== d.typeOf(e) ? e || {} : (d.each(e.split(","), function (i) { h[i] = !0 }), h) }, a.can = function (j, h) { var l, i = a.getConstructor(j), k; return i ? (l = new i({ required_caps: h }), k = l.mode, l.destroy(), !!k) : !1 }, a.thatCan = function (j, h) { var k = (h || a.order).split(/\s*,\s*/); for (var i in k) { if (a.can(k[i], j)) { return k[i] } } return null }, a.capTrue = function () { return !0 }, a.capFalse = function () { return !1 }, a.capTest = function (h) { return function () { return !!h } }, a }), a7(aS, [aZ, aT, a9], function (c, b, d) { return function a() { var e; b.extend(this, { connectRuntime: function (h) { function i(k) { var l, j; return k.length ? (l = k.shift(), (j = d.getConstructor(l)) ? (e = new j(h), e.bind("Init", function () { e.initialized = !0, setTimeout(function () { e.clients++, f.trigger("RuntimeInit", e) }, 1) }), e.bind("Error", function () { e.destroy(), i(k) }), e.mode ? (e.init(), void 0) : (e.trigger("Error"), void 0)) : (i(k), void 0)) : (f.trigger("RuntimeError", new c.RuntimeError(c.RuntimeError.NOT_INIT_ERR)), e = null, void 0) } var f = this, g; if ("string" === b.typeOf(h) ? g = h : "string" === b.typeOf(h.ruid) && (g = h.ruid), g) { if (e = d.getRuntime(g)) { return e.clients++, e } throw new c.RuntimeError(c.RuntimeError.NOT_INIT_ERR) } i((h.runtime_order || d.order).split(/\s*,\s*/)) }, getRuntime: function () { return e && e.uid ? e : (e = null, null) }, disconnectRuntime: function () { e && --e.clients <= 0 && (e.destroy(), e = null) } }) } }), a7(aP, [aT, a2, aS], function (d, b, f) { function a(h, e) { function g(j, m, l) { var i, k = c[this.uid]; return "string" === d.typeOf(k) && k.length ? (i = new a(null, { type: l, size: m - j }), i.detach(k.substr(j, i.size)), i) : null } f.call(this), h && this.connectRuntime(h), e ? "string" === d.typeOf(e) && (e = { data: e }) : e = {}, d.extend(this, { uid: e.uid || d.guid("uid_"), ruid: h, size: e.size || 0, type: e.type || "", slice: function (j, i, k) { return this.isDetached() ? g.apply(this, arguments) : this.getRuntime().exec.call(this, "Blob", "slice", this.getSource(), j, i, k) }, getSource: function () { return c[this.uid] ? c[this.uid] : null }, detach: function (i) { this.ruid && (this.getRuntime().exec.call(this, "Blob", "destroy", c[this.uid]), this.disconnectRuntime(), this.ruid = null), i = i || ""; var j = i.match(/^data:([^;]*);base64,/); j && (this.type = j[1], i = b.atob(i.substring(i.indexOf("base64,") + 7))), this.size = i.length, c[this.uid] = i }, isDetached: function () { return !this.ruid && "string" === d.typeOf(c[this.uid]) }, destroy: function () { this.detach(), delete c[this.uid] } }), e.data ? this.detach(e.data) : c[this.uid] = e } var c = {}; return a }), a7(aB, [aT, a3, aP], function (c, b, d) { function a(f, h) { var j, e; if (h || (h = {}), e = h.type && "" !== h.type ? h.type : b.getFileMime(h.name), h.name) { j = h.name.replace(/\\/g, "/"), j = j.substr(j.lastIndexOf("/") + 1) } else { var g = e.split("/")[0]; j = c.guid(("" !== g ? g : "file") + "_"), b.extensions[e] && (j += "." + b.extensions[e][0]) } d.apply(this, arguments), c.extend(this, { type: e || "", name: j || c.guid("file_"), lastModifiedDate: h.lastModifiedDate || (new Date).toLocaleString() }) } return a.prototype = d.prototype, a }), a7(bh, [aT, a3, bb, aZ, a8, be, aB, a9, aS], function (j, q, f, h, b, d, m, v, p) { function k(a) { var n = this, l, e, i; if (-1 !== j.inArray(j.typeOf(a), ["string", "node"]) && (a = { browse_button: a }), e = f.get(a.browse_button), !e) { throw new h.DOMException(h.DOMException.NOT_FOUND_ERR) } i = { accept: [{ title: d.translate("All Files"), extensions: "*" }], name: "file", multiple: !1, required_caps: !1, container: e.parentNode || document.body }, a = j.extend({}, i, a), "string" == typeof a.required_caps && (a.required_caps = v.parseCaps(a.required_caps)), "string" == typeof a.accept && (a.accept = q.mimes2extList(a.accept)), l = f.get(a.container), l || (l = document.body), "static" === f.getStyle(l, "position") && (l.style.position = "relative"), l = e = null, p.call(n), j.extend(n, { uid: j.guid("uid_"), ruid: null, files: null, init: function () { n.convertEventPropsToHandlers(g), n.bind("RuntimeInit", function (o, c) { n.ruid = c.uid, n.bind("Ready", function () { n.trigger("Refresh") }, 999), n.bind("Change", function () { var r = c.exec.call(n, "FileInput", "getFiles"); n.files = [], j.each(r, function (s) { return 0 === s.size ? !0 : (n.files.push(new m(n.ruid, s)), void 0) }) }, 999), n.bind("Refresh", function () { var u, x, r, w; r = f.get(a.browse_button), w = f.get(c.shimid), r && (u = f.getPos(r, f.get(a.container)), x = f.getSize(r), w && j.extend(w.style, { top: u.y + "px", left: u.x + "px", width: x.w + "px", height: x.h + "px" })), w = r = null }), c.exec.call(n, "FileInput", "init", a) }), n.connectRuntime(j.extend({}, a, { required_caps: { select_file: !0 } })) }, disable: function (c) { var o = this.getRuntime(); o && o.exec.call(this, "FileInput", "disable", "undefined" === j.typeOf(c) ? !0 : c) }, refresh: function () { n.trigger("Refresh") }, destroy: function () { var c = this.getRuntime(); c && (c.exec.call(this, "FileInput", "destroy"), this.disconnectRuntime()), "array" === j.typeOf(this.files) && j.each(this.files, function (o) { o.destroy() }), this.files = null } }) } var g = ["ready", "change", "cancel", "mouseenter", "mouseleave", "mousedown", "mouseup"]; return k.prototype = b.instance, k }), a7(aj, [be, bb, aZ, aT, aB, aS, a8, a3], function (h, m, f, g, b, d, k, p) { function l(i) { var c = this, e; "string" == typeof i && (i = { drop_zone: i }), e = { accept: [{ title: h.translate("All Files"), extensions: "*" }], required_caps: { drag_and_drop: !0 } }, i = "object" == typeof i ? g.extend({}, e, i) : e, i.container = m.get(i.drop_zone) || document.body, "static" === m.getStyle(i.container, "position") && (i.container.style.position = "relative"), "string" == typeof i.accept && (i.accept = p.mimes2extList(i.accept)), d.call(c), g.extend(c, { uid: g.guid("uid_"), ruid: null, files: null, init: function () { c.convertEventPropsToHandlers(j), c.bind("RuntimeInit", function (n, a) { c.ruid = a.uid, c.bind("Drop", function () { var o = a.exec.call(c, "FileDrop", "getFiles"); c.files = [], g.each(o, function (q) { c.files.push(new b(c.ruid, q)) }) }, 999), a.exec.call(c, "FileDrop", "init", i), c.dispatchEvent("ready") }), c.connectRuntime(i) }, destroy: function () { var a = this.getRuntime(); a && (a.exec.call(this, "FileDrop", "destroy"), this.disconnectRuntime()), this.files = null } }) } var j = ["ready", "dragenter", "dragleave", "drop", "error"]; return l.prototype = k.instance, l }), a7(aR, [aT, aS, a8], function (c, b, d) { function a() { this.uid = c.guid("uid_"), b.call(this), this.destroy = function () { this.disconnectRuntime(), this.unbindAll() } } return a.prototype = d.instance, a }), a7(aQ, [aT, a2, aZ, a8, aP, aB, aR], function (g, k, d, f, b, c, h) { function l() { function a(s, o) { function n(i) { e.readyState = l.DONE, e.error = i, e.trigger("error"), t() } function t() { m.destroy(), m = null, e.trigger("loadend") } function q(i) { m.bind("Error", function (u, p) { n(p) }), m.bind("Progress", function (p) { e.result = i.exec.call(m, "FileReader", "getResult"), e.trigger(p) }), m.bind("Load", function (p) { e.readyState = l.DONE, e.result = i.exec.call(m, "FileReader", "getResult"), e.trigger(p), t() }), i.exec.call(m, "FileReader", "read", s, o) } if (m = new h, this.convertEventPropsToHandlers(j), this.readyState === l.LOADING) { return n(new d.DOMException(d.DOMException.INVALID_STATE_ERR)) } if (this.readyState = l.LOADING, this.trigger("loadstart"), o instanceof b) { if (o.isDetached()) { var r = o.getSource(); switch (s) { case "readAsText": case "readAsBinaryString": this.result = r; break; case "readAsDataURL": this.result = "data:" + o.type + ";base64," + k.btoa(r) } this.readyState = l.DONE, this.trigger("load"), t() } else { q(m.connectRuntime(o.ruid)) } } else { n(new d.DOMException(d.DOMException.NOT_FOUND_ERR)) } } var e = this, m; g.extend(this, { uid: g.guid("uid_"), readyState: l.EMPTY, result: null, error: null, readAsBinaryString: function (i) { a.call(this, "readAsBinaryString", i) }, readAsDataURL: function (i) { a.call(this, "readAsDataURL", i) }, readAsText: function (i) { a.call(this, "readAsText", i) }, abort: function () { this.result = null, -1 === g.inArray(this.readyState, [l.EMPTY, l.DONE]) && (this.readyState === l.LOADING && (this.readyState = l.DONE), m && m.getRuntime().exec.call(this, "FileReader", "abort"), this.trigger("abort"), this.trigger("loadend")) }, destroy: function () { this.abort(), m && (m.getRuntime().exec.call(this, "FileReader", "destroy"), m.disconnectRuntime()), e = m = null } }) } var j = ["loadstart", "progress", "load", "abort", "error", "loadend"]; return l.EMPTY = 0, l.LOADING = 1, l.DONE = 2, l.prototype = f.instance, l }), a7(bf, [], function () { var b = function (k) { for (var g = ["source", "scheme", "authority", "userInfo", "user", "pass", "host", "port", "relative", "path", "directory", "file", "query", "fragment"], m = g.length, f = { http: 80, https: 443 }, j = {}, l = /^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/, d = l.exec(k || "") ; m--;) { d[m] && (j[g[m]] = d[m]) } if (/^[^\/]/.test(j.path) && !j.scheme) { var h = document.location.pathname; /(\/|\/[^\.]+)$/.test(h) || (h = h.replace(/[^\/]+$/, "")), j.host = document.location.hostname, j.path = h + (j.path || "") } return j.scheme || (j.scheme = document.location.protocol.replace(/:$/, "")), j.host || (j.host = document.location.hostname), j.port || (j.port = document.location.port || f[j.scheme] || 80), j.port = parseInt(j.port, 10), j.path || (j.path = "/"), delete j.source, j }, a = function (e) { var f = { http: 80, https: 443 }, d = b(e); return d.scheme + "://" + d.host + (d.port !== f[d.scheme] ? ":" + d.port : "") + d.path + (d.query ? d.query : "") }, c = function (d) { function e(f) { return [f.scheme, f.host, f.port].join("/") } return "string" == typeof d && (d = b(d)), e(b()) === e(d) }; return { parseUrl: b, resolveUrl: a, hasSameOrigin: c } }), a7(aF, [aT, aS, a2], function (b, a, c) { return function () { function d(l, h) { if (!h.isDetached()) { var g = this.connectRuntime(h.ruid).exec.call(this, "FileReaderSync", "read", l, h); return this.disconnectRuntime(), g } var k = h.getSource(); switch (l) { case "readAsBinaryString": return k; case "readAsDataURL": return "data:" + h.type + ";base64," + c.btoa(k); case "readAsText": for (var m = "", f = 0, j = k.length; j > f; f++) { m += String.fromCharCode(k[f]) } return m } } a.call(this), b.extend(this, { uid: b.guid("uid_"), readAsBinaryString: function (f) { return d.call(this, "readAsBinaryString", f) }, readAsDataURL: function (f) { return d.call(this, "readAsDataURL", f) }, readAsText: function (f) { return d.call(this, "readAsText", f) } }) } }), a7(ag, [aZ, aT, aP], function (c, b, d) { function a() { var h, f = {}, g = ""; b.extend(this, { append: function (j, k) { var e = this, i = b.typeOf(k); k instanceof d ? (h && delete f[h], h = j, f[j] = [k]) : "array" === i ? (j += "[]", b.each(k, function (l) { e.append.call(e, j, l) })) : "object" === i ? b.each(k, function (m, l) { e.append.call(e, j + "[" + l + "]", m) }) : (k = k.toString(), f[j] || (f[j] = []), f[j].push(k)) }, hasBlob: function () { return !!h }, getBlob: function () { return f[h] && f[h][0] || null }, getBlobName: function () { return h || null }, each: function (i) { b.each(f, function (j, e) { b.each(j, function (k) { i(k, e) }) }) }, destroy: function () { h = null, g = "", f = {} } }) } return a }), a7(ai, [aT, aZ, a8, a2, bf, a9, aR, aP, aF, ag, bd, a3], function (G, k, z, C, w, y, J, q, j, I, B, H) { function F() { this.uid = G.guid("uid_") } function x() { function bj(n, g) { return o.hasOwnProperty(n) ? 1 === arguments.length ? B.can("define_property") ? o[n] : Q[n] : (B.can("define_property") ? o[n] = g : Q[n] = g, void 0) : void 0 } function W(n) { function g() { at.destroy(), at = null, u.dispatchEvent("loadend"), u = null } function v(L) { at.bind("LoadStart", function (M) { bj("readyState", x.LOADING), u.dispatchEvent("readystatechange"), u.dispatchEvent(M), p && u.upload.dispatchEvent(M) }), at.bind("Progress", function (M) { bj("readyState") !== x.LOADING && (bj("readyState", x.LOADING), u.dispatchEvent("readystatechange")), u.dispatchEvent(M) }), at.bind("UploadProgress", function (M) { p && u.upload.dispatchEvent({ type: "progress", lengthComputable: !1, total: M.total, loaded: M.loaded }) }), at.bind("Load", function (M) { bj("readyState", x.DONE), bj("status", Number(L.exec.call(at, "XMLHttpRequest", "getStatus") || 0)), bj("statusText", D[bj("status")] || ""), bj("response", L.exec.call(at, "XMLHttpRequest", "getResponse", bj("responseType"))), ~G.inArray(bj("responseType"), ["text", ""]) ? bj("responseText", bj("response")) : "document" === bj("responseType") && bj("responseXML", bj("response")), a = L.exec.call(at, "XMLHttpRequest", "getAllResponseHeaders"), u.dispatchEvent("readystatechange"), bj("status") > 0 ? (p && u.upload.dispatchEvent(M), u.dispatchEvent(M)) : (m = !0, u.dispatchEvent("error")), g() }), at.bind("Abort", function (M) { u.dispatchEvent(M), g() }), at.bind("Error", function (M) { m = !0, bj("readyState", x.DONE), u.dispatchEvent("readystatechange"), Y = !0, u.dispatchEvent(M), g() }), L.exec.call(at, "XMLHttpRequest", "send", { url: bm, method: e, async: X, user: r, password: bl, headers: t, mimeType: c, encoding: bi, responseType: u.responseType, withCredentials: u.withCredentials, options: s }, n) } var u = this; l = (new Date).getTime(), at = new J, "string" == typeof s.required_caps && (s.required_caps = y.parseCaps(s.required_caps)), s.required_caps = G.extend({}, s.required_caps, { return_response_type: u.responseType }), n instanceof I && (s.required_caps.send_multipart = !0), i || (s.required_caps.do_cors = !0), s.ruid ? v(at.connectRuntime(s)) : (at.bind("RuntimeInit", function (M, L) { v(L) }), at.bind("RuntimeError", function (M, L) { u.dispatchEvent("RuntimeError", L) }), at.connectRuntime(s)) } function bk() { bj("responseText", ""), bj("responseXML", null), bj("response", null), bj("status", 0), bj("statusText", ""), l = Z = null } var Q = this, o = { timeout: 0, readyState: x.UNSENT, withCredentials: !1, status: 0, statusText: "", responseType: "", responseXML: null, responseText: null, response: null }, X = !0, bm, e, t = {}, r, bl, bi = null, c = null, d = !1, h = !1, p = !1, Y = !1, m = !1, i = !1, l, Z, V = null, f = null, s = {}, at, a = "", K; G.extend(this, o, { uid: G.guid("uid_"), upload: new F, open: function (M, n, L, v, N) { var g; if (!M || !n) { throw new k.DOMException(k.DOMException.SYNTAX_ERR) } if (/[\u0100-\uffff]/.test(M) || C.utf8_encode(M) !== M) { throw new k.DOMException(k.DOMException.SYNTAX_ERR) } if (~G.inArray(M.toUpperCase(), ["CONNECT", "DELETE", "GET", "HEAD", "OPTIONS", "POST", "PUT", "TRACE", "TRACK"]) && (e = M.toUpperCase()), ~G.inArray(e, ["CONNECT", "TRACE", "TRACK"])) { throw new k.DOMException(k.DOMException.SECURITY_ERR) } if (n = C.utf8_encode(n), g = w.parseUrl(n), i = w.hasSameOrigin(g), bm = w.resolveUrl(n), (v || N) && !i) { throw new k.DOMException(k.DOMException.INVALID_ACCESS_ERR) } if (r = v || g.user, bl = N || g.pass, X = L || !0, X === !1 && (bj("timeout") || bj("withCredentials") || "" !== bj("responseType"))) { throw new k.DOMException(k.DOMException.INVALID_ACCESS_ERR) } d = !X, h = !1, t = {}, bk.call(this), bj("readyState", x.OPENED), this.convertEventPropsToHandlers(["readystatechange"]), this.dispatchEvent("readystatechange") }, setRequestHeader: function (n, u) { var g = ["accept-charset", "accept-encoding", "access-control-request-headers", "access-control-request-method", "connection", "content-length", "cookie", "cookie2", "content-transfer-encoding", "date", "expect", "host", "keep-alive", "origin", "referer", "te", "trailer", "transfer-encoding", "upgrade", "user-agent", "via"]; if (bj("readyState") !== x.OPENED || h) { throw new k.DOMException(k.DOMException.INVALID_STATE_ERR) } if (/[\u0100-\uffff]/.test(n) || C.utf8_encode(n) !== n) { throw new k.DOMException(k.DOMException.SYNTAX_ERR) } return n = G.trim(n).toLowerCase(), ~G.inArray(n, g) || /^(proxy\-|sec\-)/.test(n) ? !1 : (t[n] ? t[n] += ", " + u : t[n] = u, !0) }, getAllResponseHeaders: function () { return a || "" }, getResponseHeader: function (g) { return g = g.toLowerCase(), m || ~G.inArray(g, ["set-cookie", "set-cookie2"]) ? null : a && "" !== a && (K || (K = {}, G.each(a.split(/\r\n/), function (u) { var v = u.split(/:\s+/); 2 === v.length && (v[0] = G.trim(v[0]), K[v[0].toLowerCase()] = { header: v[0], value: G.trim(v[1]) }) })), K.hasOwnProperty(g)) ? K[g].header + ": " + K[g].value : null }, overrideMimeType: function (g) { var n, u; if (~G.inArray(bj("readyState"), [x.LOADING, x.DONE])) { throw new k.DOMException(k.DOMException.INVALID_STATE_ERR) } if (g = G.trim(g.toLowerCase()), /;/.test(g) && (n = g.match(/^([^;]+)(?:;\scharset\=)?(.*)$/)) && (g = n[1], n[2] && (u = n[2])), !H.mimes[g]) { throw new k.DOMException(k.DOMException.SYNTAX_ERR) } V = g, f = u }, send: function (v, g) { if (s = "string" === G.typeOf(g) ? { ruid: g } : g ? g : {}, this.convertEventPropsToHandlers(A), this.upload.convertEventPropsToHandlers(A), this.readyState !== x.OPENED || h) { throw new k.DOMException(k.DOMException.INVALID_STATE_ERR) } if (v instanceof q) { s.ruid = v.ruid, c = v.type || "application/octet-stream" } else { if (v instanceof I) { if (v.hasBlob()) { var u = v.getBlob(); s.ruid = u.ruid, c = u.type || "application/octet-stream" } } else { "string" == typeof v && (bi = "UTF-8", c = "text/plain;charset=UTF-8", v = C.utf8_encode(v)) } } this.withCredentials || (this.withCredentials = s.required_caps && s.required_caps.send_browser_cookies && !i), p = !d && this.upload.hasEventListener(), m = !1, Y = !v, d || (h = !0), W.call(this, v) }, abort: function () { if (m = !0, d = !1, ~G.inArray(bj("readyState"), [x.UNSENT, x.OPENED, x.DONE])) { bj("readyState", x.UNSENT) } else { if (bj("readyState", x.DONE), h = !1, !at) { throw new k.DOMException(k.DOMException.INVALID_STATE_ERR) } at.getRuntime().exec.call(at, "XMLHttpRequest", "abort", Y), Y = !0 } }, destroy: function () { at && ("function" === G.typeOf(at.destroy) && at.destroy(), at = null), this.unbindAll(), this.upload && (this.upload.unbindAll(), this.upload = null) } }) } var D = { 100: "Continue", 101: "Switching Protocols", 102: "Processing", 200: "OK", 201: "Created", 202: "Accepted", 203: "Non-Authoritative Information", 204: "No Content", 205: "Reset Content", 206: "Partial Content", 207: "Multi-Status", 226: "IM Used", 300: "Multiple Choices", 301: "Moved Permanently", 302: "Found", 303: "See Other", 304: "Not Modified", 305: "Use Proxy", 306: "Reserved", 307: "Temporary Redirect", 400: "Bad Request", 401: "Unauthorized", 402: "Payment Required", 403: "Forbidden", 404: "Not Found", 405: "Method Not Allowed", 406: "Not Acceptable", 407: "Proxy Authentication Required", 408: "Request Timeout", 409: "Conflict", 410: "Gone", 411: "Length Required", 412: "Precondition Failed", 413: "Request Entity Too Large", 414: "Request-URI Too Long", 415: "Unsupported Media Type", 416: "Requested Range Not Satisfiable", 417: "Expectation Failed", 422: "Unprocessable Entity", 423: "Locked", 424: "Failed Dependency", 426: "Upgrade Required", 500: "Internal Server Error", 501: "Not Implemented", 502: "Bad Gateway", 503: "Service Unavailable", 504: "Gateway Timeout", 505: "HTTP Version Not Supported", 506: "Variant Also Negotiates", 507: "Insufficient Storage", 510: "Not Extended" }; F.prototype = z.instance; var A = ["loadstart", "progress", "abort", "error", "load", "timeout", "loadend"], E = 1, b = 2; return x.UNSENT = 0, x.OPENED = 1, x.HEADERS_RECEIVED = 2, x.LOADING = 3, x.DONE = 4, x.prototype = z.instance, x }), a7(an, [aT, a2, aS, a8], function (d, b, f, a) { function c() { function h() { g = k = 0, m = this.result = null } function e(o, r) { var l = this; p = r, l.bind("TransportingProgress", function (i) { k = i.loaded, g > k && -1 === d.inArray(l.state, [c.IDLE, c.DONE]) && n.call(l) }, 999), l.bind("TransportingComplete", function () { k = g, l.state = c.DONE, m = null, l.result = p.exec.call(l, "Transporter", "getAsBlob", o || "") }, 999), l.state = c.BUSY, l.trigger("TransportingStarted"), n.call(l) } function n() { var o = this, r, l = g - k; j > l && (j = l), r = b.btoa(m.substr(k, j)), p.exec.call(o, "Transporter", "receive", r, g) } var q, p, m, g, k, j; f.call(this), d.extend(this, { uid: d.guid("uid_"), state: c.IDLE, result: null, transport: function (o, v, s) { var i = this; if (s = d.extend({ chunk_size: 204798 }, s), (q = s.chunk_size % 3) && (s.chunk_size += 3 - q), j = s.chunk_size, h.call(this), m = o, g = o.length, "string" === d.typeOf(s) || s.ruid) { e.call(i, v, this.connectRuntime(s)) } else { var l = function (u, r) { i.unbind("RuntimeInit", l), e.call(i, v, r) }; this.bind("RuntimeInit", l), this.connectRuntime(s) } }, abort: function () { var i = this; i.state = c.IDLE, p && (p.exec.call(i, "Transporter", "clear"), i.trigger("TransportingAborted")), h.call(i) }, destroy: function () { this.unbindAll(), p = null, this.disconnectRuntime(), h.call(this) } }) } return c.IDLE = 0, c.BUSY = 1, c.DONE = 2, c.prototype = a.instance, c }), a7(aw, [], function () { return !!window.JSON && JSON.parse || function () { var t, j, m = { '"': '"', "\\": "\\", "/": "/", b: "\b", f: "\f", n: "\n", r: "\r", t: "	" }, b, h = function (a) { throw { name: "SyntaxError", message: a, at: t, text: b } }, x = function (a) { return a && a !== j && h("Expected '" + a + "' instead of '" + j + "'"), j = b.charAt(t), t += 1, j }, z = function () { var c, a = ""; for ("-" === j && (a = "-", x("-")) ; j >= "0" && "9" >= j;) { a += j, x() } if ("." === j) { for (a += "."; x() && j >= "0" && "9" >= j;) { a += j } } if ("e" === j || "E" === j) { for (a += j, x(), ("-" === j || "+" === j) && (a += j, x()) ; j >= "0" && "9" >= j;) { a += j, x() } } return c = +a, isFinite(c) ? c : (h("Bad number"), void 0) }, y = function () { var f, a, d = "", c; if ('"' === j) { for (; x() ;) { if ('"' === j) { return x(), d } if ("\\" === j) { if (x(), "u" === j) { for (c = 0, a = 0; 4 > a && (f = parseInt(x(), 16), isFinite(f)) ; a += 1) { c = 16 * c + f } d += String.fromCharCode(c) } else { if ("string" != typeof m[j]) { break } d += m[j] } } else { d += j } } } h("Bad string") }, w = function () { for (; j && " " >= j;) { x() } }, k = function () { switch (j) { case "t": return x("t"), x("r"), x("u"), x("e"), !0; case "f": return x("f"), x("a"), x("l"), x("s"), x("e"), !1; case "n": return x("n"), x("u"), x("l"), x("l"), null } h("Unexpected '" + j + "'") }, v, q = function () { var a = []; if ("[" === j) { if (x("["), w(), "]" === j) { return x("]"), a } for (; j;) { if (a.push(v()), w(), "]" === j) { return x("]"), a } x(","), w() } } h("Bad array") }, g = function () { var c, a = {}; if ("{" === j) { if (x("{"), w(), "}" === j) { return x("}"), a } for (; j;) { if (c = y(), w(), x(":"), Object.hasOwnProperty.call(a, c) && h('Duplicate key "' + c + '"'), a[c] = v(), w(), "}" === j) { return x("}"), a } x(","), w() } } h("Bad object") }; return v = function () { switch (w(), j) { case "{": return g(); case "[": return q(); case '"': return y(); case "-": return z(); default: return j >= "0" && "9" >= j ? z() : k() } }, function (e, c) { var f; return b = e, t = 0, j = " ", f = v(), w(), j && h("Syntax error"), "function" == typeof c ? function d(p, u) { var a, l, s = p[u]; if (s && "object" == typeof s) { for (a in s) { Object.prototype.hasOwnProperty.call(s, a) && (l = d(s, a), l !== aU ? s[a] = l : delete s[a]) } } return c.call(p, u, s) }({ "": f }, "") : f } }() }), a7(aC, [aT, bb, aZ, aF, ai, a9, aS, an, bd, a8, aP, aB, a2, aw], function (z, E, k, w, b, j, C, F, D, B, v, A, y, g) { function x() { function d(c) { if (c || (c = this.getRuntime().exec.call(this, "Image", "getInfo")), c) { if ("string" === z.typeOf(c.meta)) { try { this.meta = g(c.meta) } catch (i) { } } else { this.meta = c.meta } } z.extend(this, { size: parseInt(c.size, 10), width: parseInt(c.width, 10), height: parseInt(c.height, 10), type: c.type }), "" === this.name && (this.name = c.name) } function h(l) { var c = z.typeOf(l); try { if (l instanceof x) { if (!l.size) { throw new k.DOMException(k.DOMException.INVALID_STATE_ERR) } e.apply(this, arguments) } else { if (l instanceof v) { if (!~z.inArray(l.type, ["image/jpeg", "image/png"])) { throw new k.ImageError(k.ImageError.WRONG_FORMAT) } a.apply(this, arguments) } else { if (-1 !== z.inArray(c, ["blob", "file"])) { h.call(this, new A(null, l), arguments[1]) } else { if ("string" === c) { /^data: [^;]*; base64, /.test(l) ? h.call(this, new v(null, { data: l }), arguments[1]) : f.apply(this, arguments) } else { if ("node" !== c || "img" !== l.nodeName.toLowerCase()) { throw new k.DOMException(k.DOMException.TYPE_MISMATCH_ERR) } h.call(this, l.src, arguments[1]) } } } } } catch (m) { this.trigger("error", m) } } function e(l, m) { var c = this.connectRuntime(l.ruid); this.ruid = c.uid, c.exec.call(this, "Image", "loadFromImage", l, "undefined" === z.typeOf(m) ? !0 : m) } function a(l, o) { function c(i) { m.ruid = i.uid, i.exec.call(m, "Image", "loadFromBlob", l) } var m = this; m.name = l.name || "", l.isDetached() ? (this.bind("RuntimeInit", function (n, i) { c(i) }), o && "string" == typeof o.required_caps && (o.required_caps = j.parseCaps(o.required_caps)), this.connectRuntime(z.extend({ required_caps: { access_image_binary: !0, resize_image: !0 } }, o))) : c(this.connectRuntime(l.ruid)) } function f(m, l) { var o = this, c; c = new b, c.open("get", m), c.responseType = "blob", c.onprogress = function (i) { o.trigger(i) }, c.onload = function () { a.call(o, c.response, !0) }, c.onerror = function (i) { o.trigger(i) }, c.onloadend = function () { c.destroy() }, c.bind("RuntimeError", function (n, i) { o.trigger("RuntimeError", i) }), c.send(null, l) } C.call(this), z.extend(this, { uid: z.guid("uid_"), ruid: null, name: "", size: 0, width: 0, height: 0, type: "", meta: {}, clone: function () { this.load.apply(this, arguments) }, load: function () { this.bind("Load Resize", function () { d.call(this) }, 999), this.convertEventPropsToHandlers(q), h.apply(this, arguments) }, downsize: function (m, l, n, p) { try { if (!this.size) { throw new k.DOMException(k.DOMException.INVALID_STATE_ERR) } if (this.width > x.MAX_RESIZE_WIDTH || this.height > x.MAX_RESIZE_HEIGHT) { throw new k.ImageError(k.ImageError.MAX_RESOLUTION_ERR) } (!m && !l || "undefined" === z.typeOf(n)) && (n = !1), m = m || this.width, l = l || this.height, p = "undefined" === z.typeOf(p) ? !0 : !!p, this.getRuntime().exec.call(this, "Image", "downsize", m, l, n, p) } catch (c) { this.trigger("error", c) } }, crop: function (i, c, l) { this.downsize(i, c, !0, l) }, getAsCanvas: function () { if (!D.can("create_canvas")) { throw new k.RuntimeError(k.RuntimeError.NOT_SUPPORTED_ERR) } var c = this.connectRuntime(this.ruid); return c.exec.call(this, "Image", "getAsCanvas") }, getAsBlob: function (i, c) { if (!this.size) { throw new k.DOMException(k.DOMException.INVALID_STATE_ERR) } return i || (i = "image/jpeg"), "image/jpeg" !== i || c || (c = 90), this.getRuntime().exec.call(this, "Image", "getAsBlob", i, c) }, getAsDataURL: function (i, c) { if (!this.size) { throw new k.DOMException(k.DOMException.INVALID_STATE_ERR) } return this.getRuntime().exec.call(this, "Image", "getAsDataURL", i, c) }, getAsBinaryString: function (i, c) { var l = this.getAsDataURL(i, c); return y.atob(l.substring(l.indexOf("base64, ") + 7)) }, embed: function (H) { function n() { if (D.can("create_canvas")) { var c = M.getAsCanvas(); if (c) { return H.appendChild(c), c = null, M.destroy(), t.trigger("embedded"), void 0 } } var i = M.getAsDataURL(K, G); if (!i) { throw new k.ImageError(k.ImageError.WRONG_FORMAT) } if (D.can("use_data_uri_of", i.length)) { H.innerHTML = '<img src="' + i + '" width="' + M.width + '" height="' + M.height + '" />', M.destroy(), t.trigger("embedded") } else { var l = new F; l.bind("TransportingComplete", function () { N = t.connectRuntime(this.result.ruid), t.bind("Embedded", function () { z.extend(N.getShimContainer().style, { top: "0px", left: "0px", width: M.width + "px", height: M.height + "px" }), N = null }, 999), N.exec.call(t, "ImageView", "display", this.result.uid, u, I), M.destroy() }), l.transport(y.atob(i.substring(i.indexOf("base64, ") + 7)), K, z.extend({}, s, { required_caps: { display_media: !0 }, runtime_order: "flash, silverlight", container: H })) } } var t = this, M, K, G, J, s = arguments[1] || {}, u = this.width, I = this.height, N; try { if (!(H = E.get(H))) { throw new k.DOMException(k.DOMException.INVALID_NODE_TYPE_ERR) } if (!this.size) { throw new k.DOMException(k.DOMException.INVALID_STATE_ERR) } if (this.width > x.MAX_RESIZE_WIDTH || this.height > x.MAX_RESIZE_HEIGHT) { throw new k.ImageError(k.ImageError.MAX_RESOLUTION_ERR) } if (K = s.type || this.type || "image/jpeg", G = s.quality || 90, J = "undefined" !== z.typeOf(s.crop) ? s.crop : !1, s.width) { u = s.width, I = s.height || u } else { var L = E.getSize(H); L.w && L.h && (u = L.w, I = L.h) } return M = new x, M.bind("Resize", function () { n.call(t) }), M.bind("Load", function () { M.downsize(u, I, J, !1) }), M.clone(this, !1), M } catch (O) { this.trigger("error", O) } }, destroy: function () { this.ruid && (this.getRuntime().exec.call(this, "Image", "destroy"), this.disconnectRuntime()), this.unbindAll() } }) } var q = ["progress", "load", "error", "resize", "embedded"]; return x.MAX_RESIZE_WIDTH = 6500, x.MAX_RESIZE_HEIGHT = 6500, x.prototype = B.instance, x }), a7(aq, [aT, aZ, a9, bd], function (g, d, j, c) { function f(e) { var k = this, i = j.capTest, a = j.capTrue, l = g.extend({ access_binary: i(window.FileReader || window.File && window.File.getAsDataURL), access_image_binary: function () { return k.can("access_binary") && !!b.Image }, display_media: i(c.can("create_canvas") || c.can("use_data_uri_over32kb")), do_cors: i(window.XMLHttpRequest && "withCredentials" in new XMLHttpRequest), drag_and_drop: i(function () { var m = document.createElement("div"); return ("draggable" in m || "ondragstart" in m && "ondrop" in m) && ("IE" !== c.browser || c.version > 9) }()), filter_by_extension: i(function () { return "Chrome" === c.browser && c.version >= 28 || "IE" === c.browser && c.version >= 10 }()), return_response_headers: a, return_response_type: function (m) { return "json" === m ? !0 : c.can("return_response_type", m) }, return_status_code: a, report_upload_progress: i(window.XMLHttpRequest && (new XMLHttpRequest).upload), resize_image: function () { return k.can("access_binary") && c.can("create_canvas") }, select_file: function () { return c.can("use_fileinput") && window.File }, select_folder: function () { return k.can("select_file") && "Chrome" === c.browser && c.version >= 21 }, select_multiple: function () { return k.can("select_file") && !("Safari" === c.browser && "Windows" === c.OS) }, send_binary_string: i(window.XMLHttpRequest && ((new XMLHttpRequest).sendAsBinary || window.Uint8Array && window.ArrayBuffer)), send_custom_headers: i(window.XMLHttpRequest), send_multipart: function () { return !!(window.XMLHttpRequest && (new XMLHttpRequest).upload && window.FormData) || k.can("send_binary_string") }, slice_blob: i(window.File && (File.prototype.mozSlice || File.prototype.webkitSlice || File.prototype.slice)), stream_upload: function () { return k.can("slice_blob") && k.can("send_multipart") }, summon_file_dialog: i(function () { return "Firefox" === c.browser && c.version >= 4 || "Opera" === c.browser && c.version >= 12 || "IE" === c.browser && c.version >= 10 || !!~g.inArray(c.browser, ["Chrome", "Safari"]) }()), upload_filesize: a }, arguments[2]); j.call(this, e, arguments[1] || h, l), g.extend(this, { init: function () { this.trigger("Init") }, destroy: function (m) { return function () { m.call(k), m = k = null } }(this.destroy) }), g.extend(this.getShim(), b) } var h = "html5", b = {}; return j.addConstructor(h, f), b }), a7(ao, [aq, aP], function (b, a) { function c() { function d(j, g, k) { var f; if (!window.File.prototype.slice) { return (f = window.File.prototype.webkitSlice || window.File.prototype.mozSlice) ? f.call(j, g, k) : null } try { return j.slice(), j.slice(g, k) } catch (h) { return j.slice(g, k - g) } } this.slice = function () { return new a(this.getRuntime().uid, d.apply(this, arguments)) } } return b.Blob = c }), a7(ap, [aT], function (h) { function d() { this.returnValue = !1 } function k() { this.cancelBubble = !0 } var c = {}, g = "moxie_" + h.guid(), j = function (p, i, n, m) { var q, e; i = i.toLowerCase(), p.addEventListener ? (q = n, p.addEventListener(i, q, !1)) : p.attachEvent && (q = function () { var a = window.event; a.target || (a.target = a.srcElement), a.preventDefault = d, a.stopPropagation = k, n(a) }, p.attachEvent("on" + i, q)), p[g] || (p[g] = h.guid()), c.hasOwnProperty(p[g]) || (c[p[g]] = {}), e = c[p[g]], e.hasOwnProperty(i) || (e[i] = []), e[i].push({ func: q, orig: n, key: m }) }, b = function (l, r, p) { var e, m; if (r = r.toLowerCase(), l[g] && c[l[g]] && c[l[g]][r]) { e = c[l[g]][r]; for (var i = e.length - 1; i >= 0 && (e[i].orig !== p && e[i].key !== p || (l.removeEventListener ? l.removeEventListener(r, e[i].func, !1) : l.detachEvent && l.detachEvent("on" + r, e[i].func), e[i].orig = null, e[i].func = null, e.splice(i, 1), p === m)) ; i--) { } if (e.length || delete c[l[g]][r], h.isEmptyObj(c[l[g]])) { delete c[l[g]]; try { delete l[g] } catch (q) { l[g] = m } } } }, f = function (a, e) { a && a[g] && h.each(c[a[g]], function (m, l) { b(a, l, e) }) }; return { addEvent: j, removeEvent: b, removeAllEvents: f } }), a7(aD, [aq, aT, bb, ap, a3, bd], function (g, d, j, c, f, h) { function b() { var k = [], i; d.extend(this, { init: function (x) { var w = this, v = w.getRuntime(), n, t, r, a, o, e; i = x, k = [], r = i.accept.mimes || f.extList2mimes(i.accept, v.can("filter_by_extension")), t = v.getShimContainer(), t.innerHTML = '<input id="' + v.uid + '" type="file" style="font-size: 999px; opacity: 0; "' + (i.multiple && v.can("select_multiple") ? "multiple" : "") + (i.directory && v.can("select_folder") ? "webkitdirectory directory" : "") + (r ? ' accept="' + r.join(",") + '"' : "") + " />", n = j.get(v.uid), d.extend(n.style, { position: "absolute", top: 0, left: 0, width: "100%", height: "100%" }), a = j.get(i.browse_button), v.can("summon_file_dialog") && ("static" === j.getStyle(a, "position") && (a.style.position = "relative"), o = parseInt(j.getStyle(a, "z-index"), 10) || 1, a.style.zIndex = o, t.style.zIndex = o - 1, c.addEvent(a, "click", function (m) { var l = j.get(v.uid); l && !l.disabled && l.click(), m.preventDefault() }, w.uid)), e = v.can("summon_file_dialog") ? a : t, c.addEvent(e, "mouseover", function () { w.trigger("mouseenter") }, w.uid), c.addEvent(e, "mouseout", function () { w.trigger("mouseleave") }, w.uid), c.addEvent(e, "mousedown", function () { w.trigger("mousedown") }, w.uid), c.addEvent(j.get(i.container), "mouseup", function () { w.trigger("mouseup") }, w.uid), n.onchange = function q() { if (k = [], i.directory ? d.each(this.files, function (m) { "." !== m.name && k.push(m) }) : k = [].slice.call(this.files), "IE" !== h.browser) { this.value = "" } else { var l = this.cloneNode(!0); this.parentNode.replaceChild(l, this), l.onchange = q } w.trigger("change") }, w.trigger({ type: "ready", async: !0 }), t = null }, getFiles: function () { return k }, disable: function (m) { var l = this.getRuntime(), a; (a = j.get(l.uid)) && (a.disabled = !!m) }, destroy: function () { var a = this.getRuntime(), e = a.getShimContainer(); c.removeAllEvents(e, this.uid), c.removeAllEvents(i && j.get(i.container), this.uid), c.removeAllEvents(i && j.get(i.browse_button), this.uid), e && (e.innerHTML = ""), k = i = null } }) } return g.FileInput = b }), a7(aA, [aq, aT, bb, ap, a3], function (d, b, g, a, c) { function f() { function m(o) { for (var r = [], l = 0; l < o.length; l++) { [].push.apply(r, o[l].extensions.split(/\s*,\s*/)) } return -1 === b.inArray("*", r) ? r : [] } function p(l) { var o = c.getFileExtension(l.name); return !o || !h.length || -1 !== b.inArray(o, h) } function i(o, r) { var l = []; b.each(o, function (s) { l.push(function (e) { k(s, e) }) }), b.inSeries(l, function () { r() }) } function k(o, l) { o.isFile ? o.file(function (r) { p(r) && q.push(r), l() }, function () { l() }) : o.isDirectory ? j(o, l) : l() } function j(u, o) { function v(r) { s.readEntries(function (e) { e.length ? ([].push.apply(l, e), v(r)) : r() }, r) } var l = [], s = u.createReader(); v(function () { i(l, o) }) } var q = [], h = [], n; b.extend(this, { init: function (o) { var l = this, e; n = o, h = m(n.accept), e = n.container, a.addEvent(e, "dragover", function (r) { r.preventDefault(), r.stopPropagation(), r.dataTransfer.dropEffect = "copy" }, l.uid), a.addEvent(e, "drop", function (r) { if (r.preventDefault(), r.stopPropagation(), q = [], r.dataTransfer.items && r.dataTransfer.items[0].webkitGetAsEntry) { var s = []; b.each(r.dataTransfer.items, function (t) { s.push(t.webkitGetAsEntry()) }), i(s, function () { l.trigger("drop") }) } else { b.each(r.dataTransfer.files, function (t) { p(t) && q.push(t) }), l.trigger("drop") } }, l.uid), a.addEvent(e, "dragenter", function (r) { r.preventDefault(), r.stopPropagation(), l.trigger("dragenter") }, l.uid), a.addEvent(e, "dragleave", function (r) { r.preventDefault(), r.stopPropagation(), l.trigger("dragleave") }, l.uid) }, getFiles: function () { return q }, destroy: function () { a.removeAllEvents(n && g.get(n.container), this.uid), q = h = n = null } }) } return d.FileDrop = f }), a7(am, [aq, a2, aT], function (c, b, d) { function a() { function h(i) { return b.atob(i.substring(i.indexOf("base64, ") + 7)) } var f, g = !1; d.extend(this, { read: function (j, i) { var k = this; f = new window.FileReader, f.addEventListener("progress", function (l) { k.trigger(l) }), f.addEventListener("load", function (l) { k.trigger(l) }), f.addEventListener("error", function (l) { k.trigger(l, f.error) }), f.addEventListener("loadend", function () { f = null }), "function" === d.typeOf(f[j]) ? (g = !1, f[j](i.getSource())) : "readAsBinaryString" === j && (g = !0, f.readAsDataURL(i.getSource())) }, getResult: function () { return f && f.result ? g ? h(f.result) : f.result : null }, abort: function () { f && f.abort() }, destroy: function () { f = null } }) } return c.FileReader = a }), a7(ax, [aq, aT, a3, bf, aB, aP, ag, aZ, bd, aw], function (j, q, f, h, b, d, m, v, p, k) { function g() { function o(w, s) { var x = this, l, u; l = s.getBlob().getSource(), u = new window.FileReader, u.onload = function () { s.append(s.getBlobName(), new d(null, { type: l.type, data: u.result })), self.send.call(x, w, s) }, u.readAsBinaryString(l) } function a() { return !window.XMLHttpRequest || "IE" === p.browser && p.version < 8 ? function () { for (var s = ["Msxml2.XMLHTTP.6.0", "Microsoft.XMLHTTP"], l = 0; l < s.length; l++) { try { return new ActiveXObject(s[l]) } catch (u) { } } }() : new window.XMLHttpRequest } function r(s) { var l = s.responseXML, u = s.responseText; return "IE" === p.browser && u && l && !l.documentElement && /[^\/]+\/[^\+]+\+xml/.test(s.getResponseHeader("Content-Type")) && (l = new window.ActiveXObject("Microsoft.XMLDOM"), l.async = !1, l.validateOnParse = !1, l.loadXML(u)), l && ("IE" === p.browser && 0 !== l.parseError || !l.documentElement || "parsererror" === l.documentElement.tagName) ? null : l } function i(x) { var u = "----moxieboundary" + (new Date).getTime(), y = "--", s = "\r\n", w = "", l = this.getRuntime(); if (!l.can("send_binary_string")) { throw new v.RuntimeError(v.RuntimeError.NOT_SUPPORTED_ERR) } return n.setRequestHeader("Content-Type", "multipart/form-data; boundary=" + u), x.each(function (z, t) { w += z instanceof d ? y + u + s + 'Content-Disposition: form-data; name="' + t + '"; filename="' + unescape(encodeURIComponent(z.name || "blob")) + '"' + s + "Content-Type: " + z.type + s + s + z.getSource() + s : y + u + s + 'Content-Disposition: form-data; name="' + t + '"' + s + s + unescape(encodeURIComponent(z)) + s }), w += y + u + y + s } var n, c; q.extend(this, { send: function (z, w) { var t = this, y = "Mozilla" === p.browser && p.version >= 4 && p.version < 7, x = "Android Browser" === p.browser, e = !1; if (c = z.url.replace(/^.+?\/([\w\-\.]+)$/, "$1").toLowerCase(), n = a(), n.open(z.method, z.url, z.async, z.user, z.password), w instanceof d) { w.isDetached() && (e = !0), w = w.getSource() } else { if (w instanceof m) { if (w.hasBlob()) { if (w.getBlob().isDetached()) { w = i.call(t, w), e = !0 } else { if ((y || x) && "blob" === q.typeOf(w.getBlob().getSource()) && window.FileReader) { return o.call(t, z, w), void 0 } } } if (w instanceof m) { var u = new window.FormData; w.each(function (A, s) { A instanceof d ? u.append(s, A.getSource()) : u.append(s, A) }), w = u } } } n.upload ? (z.withCredentials && (n.withCredentials = !0), n.addEventListener("load", function (s) { t.trigger(s) }), n.addEventListener("error", function (s) { t.trigger(s) }), n.addEventListener("progress", function (s) { t.trigger(s) }), n.upload.addEventListener("progress", function (s) { t.trigger({ type: "UploadProgress", loaded: s.loaded, total: s.total }) })) : n.onreadystatechange = function l() { switch (n.readyState) { case 1: break; case 2: break; case 3: var B, s; try { h.hasSameOrigin(z.url) && (B = n.getResponseHeader("Content-Length") || 0), n.responseText && (s = n.responseText.length) } catch (A) { B = s = 0 } t.trigger({ type: "progress", lengthComputable: !!B, total: parseInt(B, 10), loaded: s }); break; case 4: n.onreadystatechange = function () { }, 0 === n.status ? t.trigger("error") : t.trigger("load") } }, q.isEmptyObj(z.headers) || q.each(z.headers, function (A, s) { n.setRequestHeader(s, A) }), "" !== z.responseType && "responseType" in n && (n.responseType = "json" !== z.responseType || p.can("return_response_type", "json") ? z.responseType : "text"), e ? n.sendAsBinary ? n.sendAsBinary(w) : function () { for (var A = new Uint8Array(w.length), s = 0; s < w.length; s++) { A[s] = 255 & w.charCodeAt(s) } n.send(A.buffer) }() : n.send(w), t.trigger("loadstart") }, getStatus: function () { try { if (n) { return n.status } } catch (l) { } return 0 }, getResponse: function (y) { var w = this.getRuntime(); try { switch (y) { case "blob": var u = new b(w.uid, n.response), z = n.getResponseHeader("Content-Disposition"); if (z) { var l = z.match(/filename=([\'\"'])([^\1]+)\1/); l && (c = l[2]) } return u.name = c, u.type || (u.type = f.getFileMime(c)), u; case "json": return p.can("return_response_type", "json") ? n.response : 200 === n.status ? k(n.responseText) : null; case "document": return r(n); default: return "" !== n.responseText ? n.responseText : null } } catch (x) { return null } }, getAllResponseHeaders: function () { try { return n.getAllResponseHeaders() } catch (l) { } return "" }, abort: function () { n && n.abort() }, destroy: function () { self = c = null } }) } return j.XMLHttpRequest = g }), a7(aE, [], function () { return function () { function c(k, j) { var l = b ? 0 : -8 * (j - 1), h = 0, g; for (g = 0; j > g; g++) { h |= d.charCodeAt(k + g) << Math.abs(l + 8 * g) } return h } function f(h, g, i) { i = 3 === arguments.length ? i : d.length - g - 1, d = d.substr(0, g) + h + d.substr(i + g) } function a(l, j, h) { var m = "", g = b ? 0 : -8 * (h - 1), k; for (k = 0; h > k; k++) { m += String.fromCharCode(255 & j >> Math.abs(g + 8 * k)) } f(m, l, h) } var b = !1, d; return { II: function (g) { return g === aU ? b : (b = g, void 0) }, init: function (g) { b = !1, d = g }, SEGMENT: function (j, h, g) { switch (arguments.length) { case 1: return d.substr(j, d.length - j - 1); case 2: return d.substr(j, h); case 3: f(g, j, h); break; default: return d } }, BYTE: function (e) { return c(e, 1) }, SHORT: function (e) { return c(e, 2) }, LONG: function (g, e) { return e === aU ? c(g, 4) : (a(g, e, 4), void 0) }, SLONG: function (e) { var g = c(e, 4); return g > 2147483647 ? g - 4294967296 : g }, STRING: function (g, h) { var e = ""; for (h += g; h > g; g++) { e += String.fromCharCode(c(g, 1)) } return e } } } }), a7(af, [aE], function (b) { return function a(h) { var d = [], f, g, c, e = 0; if (f = new b, f.init(h), 65496 === f.SHORT(0)) { for (g = 2; g <= h.length;) { if (c = f.SHORT(g), c >= 65488 && 65495 >= c) { g += 2 } else { if (65498 === c || 65497 === c) { break } e = f.SHORT(g + 2) + 2, c >= 65505 && 65519 >= c && d.push({ hex: c, name: "APP" + (15 & c), start: g, length: e, segment: f.SEGMENT(g, e) }), g += e } } return f.init(null), { headers: d, restore: function (j) { var i, k; for (f.init(j), g = 65504 == f.SHORT(2) ? 4 + f.SHORT(4) : 2, k = 0, i = d.length; i > k; k++) { f.SEGMENT(g, 0, d[k].segment), g += d[k].length } return j = f.SEGMENT(), f.init(null), j }, strip: function (k) { var m, j, l; for (j = new a(k), m = j.headers, j.purge(), f.init(k), l = m.length; l--;) { f.SEGMENT(m[l].start, m[l].length, "") } return k = f.SEGMENT(), f.init(null), k }, get: function (k) { for (var i = [], l = 0, j = d.length; j > l; l++) { d[l].name === k.toUpperCase() && i.push(d[l].segment) } return i }, set: function (l, j) { var p = [], k, m, i; for ("string" == typeof j ? p.push(j) : p = j, k = m = 0, i = d.length; i > k && (d[k].name === l.toUpperCase() && (d[k].segment = p[m], d[k].length = p[m].length, m++), !(m >= p.length)) ; k++) { } }, purge: function () { d = [], f.init(null), f = null } } } } }), a7(az, [aT, aE], function (b, c) { return function a() { function g(B, v) { var x = e.SHORT(B), l, t, E, D, C, A, q, y, w = [], z = {}; for (l = 0; x > l; l++) { if (q = A = B + 12 * l + 2, E = v[e.SHORT(q)], E !== aU) { switch (D = e.SHORT(q += 2), C = e.LONG(q += 2), q += 4, w = [], D) { case 1: case 7: for (C > 4 && (q = e.LONG(q) + m.tiffHeader), t = 0; C > t; t++) { w[t] = e.BYTE(q + t) } break; case 2: C > 4 && (q = e.LONG(q) + m.tiffHeader), z[E] = e.STRING(q, C - 1); continue; case 3: for (C > 2 && (q = e.LONG(q) + m.tiffHeader), t = 0; C > t; t++) { w[t] = e.SHORT(q + 2 * t) } break; case 4: for (C > 1 && (q = e.LONG(q) + m.tiffHeader), t = 0; C > t; t++) { w[t] = e.LONG(q + 4 * t) } break; case 5: for (q = e.LONG(q) + m.tiffHeader, t = 0; C > t; t++) { w[t] = e.LONG(q + 4 * t) / e.LONG(q + 4 * t + 4) } break; case 9: for (q = e.LONG(q) + m.tiffHeader, t = 0; C > t; t++) { w[t] = e.SLONG(q + 4 * t) } break; case 10: for (q = e.LONG(q) + m.tiffHeader, t = 0; C > t; t++) { w[t] = e.SLONG(q + 4 * t) / e.SLONG(q + 4 * t + 4) } break; default: continue } y = 1 == C ? w[0] : w, z[E] = d.hasOwnProperty(E) && "object" != typeof y ? d[E][y] : y } } return z } function j() { var i = m.tiffHeader; return e.II(18761 == e.SHORT(i)), 42 !== e.SHORT(i += 2) ? !1 : (m.IFD0 = m.tiffHeader + e.LONG(i += 2), f = g(m.IFD0, h.tiff), "ExifIFDPointer" in f && (m.exifIFD = m.tiffHeader + f.ExifIFDPointer, delete f.ExifIFDPointer), "GPSInfoIFDPointer" in f && (m.gpsIFD = m.tiffHeader + f.GPSInfoIFDPointer, delete f.GPSInfoIFDPointer), !0) } function k(y, B, s) { var w, p, q, A = 0; if ("string" == typeof B) { var v = h[y.toLowerCase()]; for (var z in v) { if (v[z] === B) { B = z; break } } } w = m[y.toLowerCase() + "IFD"], p = e.SHORT(w); for (var x = 0; p > x; x++) { if (q = w + 12 * x + 2, e.SHORT(q) == B) { A = q + 8; break } } return A ? (e.LONG(A, s), !0) : !1 } var e, h, f, m = {}, d; return e = new c, h = { tiff: { 274: "Orientation", 270: "ImageDescription", 271: "Make", 272: "Model", 305: "Software", 34665: "ExifIFDPointer", 34853: "GPSInfoIFDPointer" }, exif: { 36864: "ExifVersion", 40961: "ColorSpace", 40962: "PixelXDimension", 40963: "PixelYDimension", 36867: "DateTimeOriginal", 33434: "ExposureTime", 33437: "FNumber", 34855: "ISOSpeedRatings", 37377: "ShutterSpeedValue", 37378: "ApertureValue", 37383: "MeteringMode", 37384: "LightSource", 37385: "Flash", 37386: "FocalLength", 41986: "ExposureMode", 41987: "WhiteBalance", 41990: "SceneCaptureType", 41988: "DigitalZoomRatio", 41992: "Contrast", 41993: "Saturation", 41994: "Sharpness" }, gps: { 0: "GPSVersionID", 1: "GPSLatitudeRef", 2: "GPSLatitude", 3: "GPSLongitudeRef", 4: "GPSLongitude" } }, d = { ColorSpace: { 1: "sRGB", 0: "Uncalibrated" }, MeteringMode: { 0: "Unknown", 1: "Average", 2: "CenterWeightedAverage", 3: "Spot", 4: "MultiSpot", 5: "Pattern", 6: "Partial", 255: "Other" }, LightSource: { 1: "Daylight", 2: "Fliorescent", 3: "Tungsten", 4: "Flash", 9: "Fine weather", 10: "Cloudy weather", 11: "Shade", 12: "Daylight fluorescent (D 5700 -7100K) ", 13: "Day white fluorescent (N 4600 -5400K) ", 14: "Cool white fluorescent (W 3900 -4500K) ", 15: "White fluorescent (WW 3200 -3700K) ", 17: "Standard light A", 18: "Standard light B", 19: "Standard light C", 20: "D55", 21: "D65", 22: "D75", 23: "D50", 24: "ISO studio tungsten", 255: "Other" }, Flash: { 0: "Flash did not fire.", 1: "Flash fired.", 5: "Strobe return light not detected.", 7: "Strobe return light detected.", 9: "Flash fired, compulsory flash mode", 13: "Flash fired, compulsory flash mode, return light not detected", 15: "Flash fired, compulsory flash mode, return light detected", 16: "Flash did not fire, compulsory flash mode", 24: "Flash did not fire, auto mode", 25: "Flash fired, auto mode", 29: "Flash fired, auto mode, return light not detected", 31: "Flash fired, auto mode, return light detected", 32: "No flash function", 65: "Flash fired, red-eye reduction mode", 69: "Flash fired, red-eye reduction mode, return light not detected", 71: "Flash fired, red-eye reduction mode, return light detected", 73: "Flash fired, compulsory flash mode, red-eye reduction mode", 77: "Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected", 79: "Flash fired, compulsory flash mode, red-eye reduction mode, return light detected", 89: "Flash fired, auto mode, red-eye reduction mode", 93: "Flash fired, auto mode, return light not detected, red-eye reduction mode", 95: "Flash fired, auto mode, return light detected, red-eye reduction mode" }, ExposureMode: { 0: "Auto exposure", 1: "Manual exposure", 2: "Auto bracket" }, WhiteBalance: { 0: "Auto white balance", 1: "Manual white balance" }, SceneCaptureType: { 0: "Standard", 1: "Landscape", 2: "Portrait", 3: "Night scene" }, Contrast: { 0: "Normal", 1: "Soft", 2: "Hard" }, Saturation: { 0: "Normal", 1: "Low saturation", 2: "High saturation" }, Sharpness: { 0: "Normal", 1: "Soft", 2: "Hard" }, GPSLatitudeRef: { N: "North latitude", S: "South latitude" }, GPSLongitudeRef: { E: "East longitude", W: "West longitude" } }, { init: function (i) { return m = { tiffHeader: 10 }, i !== aU && i.length ? (e.init(i), 65505 === e.SHORT(0) && "EXIF\0" === e.STRING(4, 5).toUpperCase() ? j() : !1) : !1 }, TIFF: function () { return f }, EXIF: function () { var i; if (i = g(m.exifIFD, h.exif), i.ExifVersion && "array" === b.typeOf(i.ExifVersion)) { for (var o = 0, l = ""; o < i.ExifVersion.length; o++) { l += String.fromCharCode(i.ExifVersion[o]) } i.ExifVersion = l } return i }, GPS: function () { var i; return i = g(m.gpsIFD, h.gps), i.GPSVersionID && "array" === b.typeOf(i.GPSVersionID) && (i.GPSVersionID = i.GPSVersionID.join(".")), i }, setExif: function (l, i) { return "PixelXDimension" !== l && "PixelYDimension" !== l ? !1 : k("exif", l, i) }, getBinary: function () { return e.SEGMENT() }, purge: function () { e.init(null), e = f = null, m = {} } } } }), a7(aO, [aT, aZ, af, aE, az], function (d, b, g, a, c) { function f(h) { function n() { for (var o = 0, l, p; o <= q.length;) { if (l = m.SHORT(o += 2), l >= 65472 && 65475 >= l) { return o += 5, { height: m.SHORT(o), width: m.SHORT(o += 2) } } p = m.SHORT(o += 2), o += p - 2 } return null } function r() { k && i && m && (k.purge(), i.purge(), m.init(null), q = j = i = k = m = null) } var q, m, i, k, j, e; if (q = h, m = new a, m.init(q), 65496 !== m.SHORT(0)) { throw new b.ImageError(b.ImageError.WRONG_FORMAT) } i = new g(h), k = new c, e = !!k.init(i.get("app1")[0]), j = n.call(this), d.extend(this, { type: "image/jpeg", size: q.length, width: j && j.width || 0, height: j && j.height || 0, setExif: function (l, o) { return e ? ("object" === d.typeOf(l) ? d.each(l, function (s, p) { k.setExif(p, s) }) : k.setExif(l, o), i.set("app1", k.getBinary()), void 0) : !1 }, writeHeaders: function () { return arguments.length ? i.restore(arguments[0]) : q = i.restore(q) }, stripHeaders: function (l) { return i.strip(l) }, purge: function () { r.call(this) } }), e && (this.meta = { tiff: k.TIFF(), exif: k.EXIF(), gps: k.GPS() }) } return f }), a7(aX, [aZ, aT, aE], function (c, b, d) { function a(h) { function e() { var l, i; return l = m.call(this, 8), "IHDR" == l.type ? (i = l.start, { width: n.LONG(i), height: n.LONG(i += 4) }) : null } function f() { n && (n.init(null), p = j = k = g = n = null) } function m(s) { var o, u, l, q; return o = n.LONG(s), u = n.STRING(s += 4, 4), l = s += 4, q = n.LONG(s + o), { length: o, type: u, start: l, CRC: q } } var p, n, k, g, j; p = h, n = new d, n.init(p), function () { var o = 0, q = 0, l = [35152, 20039, 3338, 6666]; for (q = 0; q < l.length; q++, o += 2) { if (l[q] != n.SHORT(o)) { throw new c.ImageError(c.ImageError.WRONG_FORMAT) } } }(), j = e.call(this), b.extend(this, { type: "image/png", size: p.length, width: j.width, height: j.height, purge: function () { f.call(this) } }), f.call(this) } return a }), a7(a4, [aT, aZ, aO, aX], function (c, b, d, a) { return function (f) { var g = [d, a], e; e = function () { for (var h = 0; h < g.length; h++) { try { return new g[h](f) } catch (i) { } } throw new b.ImageError(b.ImageError.WRONG_FORMAT) }(), c.extend(this, { type: "", size: 0, width: 0, height: 0, setExif: function () { }, writeHeaders: function (h) { return h }, stripHeaders: function (h) { return h }, purge: function () { } }), c.extend(this, e), this.purge = function () { e.purge(), e = null } } }), a7(ac, [], function () { function b(M, I, C) { var F = M.naturalWidth, P = M.naturalHeight, B = C.width, z = C.height, O = C.x || 0, H = C.y || 0, N = I.getContext("2d"); a(M) && (F /= 2, P /= 2); var L = 1024, D = document.createElement("canvas"); D.width = D.height = L; for (var J = D.getContext("2d"), G = c(M, F, P), K = 0; P > K;) { for (var t = K + L > P ? P - K : L, k = 0; F > k;) { var A = k + L > F ? F - k : L; J.clearRect(0, 0, L, L), J.drawImage(M, -k, -K); var Q = k * B / F + O << 0, j = Math.ceil(A * B / F), q = K * z / P / G + H << 0, n = Math.ceil(t * z / P / G); N.drawImage(D, 0, 0, A, t, Q, q, j, n), k += L } K += L } D = J = null } function a(h) { var f = h.naturalWidth, j = h.naturalHeight; if (f * j > 1048576) { var d = document.createElement("canvas"); d.width = d.height = 1; var g = d.getContext("2d"); return g.drawImage(h, -f + 1, 0), 0 === g.getImageData(0, 0, 1, 1).data[3] } return !1 } function c(k, v, g) { var j = document.createElement("canvas"); j.width = 1, j.height = g; var d = j.getContext("2d"); d.drawImage(k, 0, 0); for (var f = d.getImageData(0, 0, 1, g).data, p = 0, w = g, q = g; q > p;) { var m = f[4 * (q - 1) + 3]; 0 === m ? w = q : p = q, q = w + p >> 1 } j = null; var h = q / g; return 0 === h ? 1 : h } return { isSubsampled: a, renderTo: b } }), a7(a6, [aq, aT, aZ, a2, aP, a4, ac, a3, bd], function (h, m, f, g, b, d, k, p, l) { function j() { function t() { if (!F && !B) { throw new f.ImageError(f.DOMException.INVALID_STATE_ERR) } return F || B } function z(c) { return g.atob(c.substring(c.indexOf("base64,") + 7)) } function n(v, c) { return "data:" + (c || "") + ";base64," + g.btoa(v) } function u(v) { var c = this; B = new Image, B.onerror = function () { r.call(this), c.trigger("error", new f.ImageError(f.ImageError.WRONG_FORMAT)) }, B.onload = function () { c.trigger("load") }, B.src = /^data:[^;]*;base64,/.test(v) ? v : n(v, D.type) } function s(x, v) { var c = this, w; return window.FileReader ? (w = new FileReader, w.onload = function () { v(this.result) }, w.onerror = function () { c.trigger("error", new f.FileException(f.FileException.NOT_READABLE_ERR)) }, w.readAsDataURL(x), void 0) : v(x.getAsDataURL()) } function a(E, J, e, x) { var P = this, S, R, N, I, M, L, w, K, Q; if (A = x, Q = this.meta && this.meta.tiff && this.meta.tiff.Orientation || 1, -1 !== m.inArray(Q, [5, 6, 7, 8])) { var O = E; E = J, J = O } return L = t(), N = e ? Math.max : Math.min, R = N(E / L.width, J / L.height), R > 1 && (!e || x) ? (this.trigger("Resize"), void 0) : (w = Math.round(L.width * R), K = Math.round(L.height * R), F || (F = document.createElement("canvas")), S = F.getContext("2d"), e ? (F.width = E, F.height = J) : (F.width = w, F.height = K), I = w > F.width ? Math.round((w - F.width) / 2) : 0, M = K > F.height ? Math.round((K - F.height) / 2) : 0, A || i(F.width, F.height, Q), q.call(this, L, F, -I, -M, w, K), this.width = F.width, this.height = F.height, C = !0, P.trigger("Resize"), void 0) } function q(y, v, I, c, x, E) { if ("iOS" === l.OS) { k.renderTo(y, v, { width: x, height: E, x: I, y: c }) } else { var w = v.getContext("2d"); w.drawImage(y, I, c, x, E) } } function i(w, v, x) { switch (x) { case 5: case 6: case 7: case 8: F.width = v, F.height = w; break; default: F.width = w, F.height = v } var c = F.getContext("2d"); switch (x) { case 2: c.translate(w, 0), c.scale(-1, 1); break; case 3: c.translate(w, v), c.rotate(Math.PI); break; case 4: c.translate(0, v), c.scale(1, -1); break; case 5: c.rotate(0.5 * Math.PI), c.scale(1, -1); break; case 6: c.rotate(0.5 * Math.PI), c.translate(0, -v); break; case 7: c.rotate(0.5 * Math.PI), c.translate(w, -v), c.scale(-1, 1); break; case 8: c.rotate(-0.5 * Math.PI), c.translate(-w, 0) } } function r() { H && (H.purge(), H = null), o = B = F = D = null, C = !1 } var G = this, B, H, F, o, D, C = !1, A = !0; m.extend(this, { loadFromBlob: function (x) { var v = this, c = v.getRuntime(), w = arguments.length > 1 ? arguments[1] : !0; if (!c.can("access_binary")) { throw new f.RuntimeError(f.RuntimeError.NOT_SUPPORTED_ERR) } return D = x, x.isDetached() ? (o = x.getSource(), u.call(this, o), void 0) : (s.call(this, x.getSource(), function (y) { w && (o = z(y)), u.call(v, y) }), void 0) }, loadFromImage: function (v, c) { this.meta = v.meta, D = new b(null, { name: v.name, size: v.size, type: v.type }), u.call(this, c ? o = v.getAsBinaryString() : v.getAsDataURL()) }, getInfo: function () { var c = this.getRuntime(), e; return !H && o && c.can("access_image_binary") && (H = new d(o)), e = { width: t().width || 0, height: t().height || 0, type: D.type || p.getFileMime(D.name), size: o && o.length || D.size || 0, name: D.name || "", meta: H && H.meta || this.meta || {} } }, downsize: function () { a.apply(this, arguments) }, getAsCanvas: function () { return F && (F.id = this.uid + "_canvas"), F }, getAsBlob: function (v, c) { return v !== this.type && a.call(this, this.width, this.height, !1), new b(null, { type: v, data: G.getAsBinaryString.call(this, v, c) }) }, getAsDataURL: function (v) { var c = arguments[1] || 90; if (!C) { return B.src } if ("image/jpeg" !== v) { return F.toDataURL("image/png") } try { return F.toDataURL("image/jpeg", c / 100) } catch (w) { return F.toDataURL("image/jpeg") } }, getAsBinaryString: function (w, v) { if (!C) { return o || (o = z(G.getAsDataURL(w, v))), o } if ("image/jpeg" !== w) { o = z(G.getAsDataURL(w, v)) } else { var x; v || (v = 90); try { x = F.toDataURL("image/jpeg", v / 100) } catch (c) { x = F.toDataURL("image/jpeg") } o = z(x), H && (o = H.stripHeaders(o), A && (H.meta && H.meta.exif && H.setExif({ PixelXDimension: this.width, PixelYDimension: this.height }), o = H.writeHeaders(o)), H.purge(), H = null) } return C = !1, o }, destroy: function () { G = null, r.call(this), this.getRuntime().getShim().removeInstance(this.uid) } }) } return h.Image = j }), a7(ae, [aT, bd, bb, aZ, a9], function (g, k, d, f, b) { function c() { var i; try { i = navigator.plugins["Shockwave Flash"], i = i.description } catch (a) { try { i = new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version") } catch (m) { i = "0.0" } } return i = i.match(/\d+/g), parseFloat(i[0] + "." + i[1]) } function h(i) { var m = this, e; i = g.extend({ swf_url: k.swf_url }, i), b.call(this, i, l, { access_binary: function (a) { return a && "browser" === m.mode }, access_image_binary: function (a) { return a && "browser" === m.mode }, display_media: b.capTrue, do_cors: b.capTrue, drag_and_drop: !1, report_upload_progress: function () { return "client" === m.mode }, resize_image: b.capTrue, return_response_headers: !1, return_response_type: function (a) { return !g.arrayDiff(a, ["", "text", "json", "document"]) || "browser" === m.mode }, return_status_code: function (a) { return "browser" === m.mode || !g.arrayDiff(a, [200, 404]) }, select_file: b.capTrue, select_multiple: b.capTrue, send_binary_string: function (a) { return a && "browser" === m.mode }, send_browser_cookies: function (a) { return a && "browser" === m.mode }, send_custom_headers: function (a) { return a && "browser" === m.mode }, send_multipart: b.capTrue, slice_blob: b.capTrue, stream_upload: function (a) { return a && "browser" === m.mode }, summon_file_dialog: !1, upload_filesize: function (a) { return g.parseSizeStr(a) <= 2097152 || "client" === m.mode }, use_http_method: function (a) { return !g.arrayDiff(a, ["GET", "POST"]) } }, { access_binary: function (a) { return a ? "browser" : "client" }, access_image_binary: function (a) { return a ? "browser" : "client" }, report_upload_progress: function (a) { return a ? "browser" : "client" }, return_response_type: function (a) { return g.arrayDiff(a, ["", "text", "json", "document"]) ? "browser" : ["client", "browser"] }, return_status_code: function (a) { return g.arrayDiff(a, [200, 404]) ? "browser" : ["client", "browser"] }, send_binary_string: function (a) { return a ? "browser" : "client" }, send_browser_cookies: function (a) { return a ? "browser" : "client" }, send_custom_headers: function (a) { return a ? "browser" : "client" }, stream_upload: function (a) { return a ? "client" : "browser" }, upload_filesize: function (a) { return g.parseSizeStr(a) >= 2097152 ? "client" : "browser" } }, "client"), c() < 10 && (this.mode = !1), g.extend(this, { getShim: function () { return d.get(this.uid) }, shimExec: function (o, a) { var p = [].slice.call(arguments, 2); return m.getShim().exec(this.uid, o, a, p) }, init: function () { var q, a, p; p = this.getShimContainer(), g.extend(p.style, { position: "absolute", top: "-8px", left: "-8px", width: "9px", height: "9px", overflow: "hidden" }), q = '<object id="' + this.uid + '" type="application/x-shockwave-flash" data="' + i.swf_url + '" ', "IE" === k.browser && (q += 'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '), q += 'width="100%" height="100%" style="outline:0"><param name="movie" value="' + i.swf_url + '" /><param name="flashvars" value="uid=' + escape(this.uid) + "&target=" + k.global_event_dispatcher + '" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>', "IE" === k.browser ? (a = document.createElement("div"), p.appendChild(a), a.outerHTML = q, a = p = null) : p.innerHTML = q, e = setTimeout(function () { m && !m.initialized && m.trigger("Error", new f.RuntimeError(f.RuntimeError.NOT_INIT_ERR)) }, 5000) }, destroy: function (a) { return function () { a.call(m), clearTimeout(e), i = e = a = m = null } }(this.destroy) }, j) } var l = "flash", j = {}; return b.addConstructor(l, h), j }), a7(ad, [ae, aP], function (b, a) { var c = { slice: function (g, j, d, f) { var h = this.getRuntime(); return 0 > j ? j = Math.max(g.size + j, 0) : j > 0 && (j = Math.min(j, g.size)), 0 > d ? d = Math.max(g.size + d, 0) : d > 0 && (d = Math.min(d, g.size)), g = h.shimExec.call(this, "Blob", "slice", j, d, f || ""), g && (g = new a(h.uid, g)), g } }; return b.Blob = c }), a7(ab, [ae], function (b) { var a = { init: function (c) { this.getRuntime().shimExec.call(this, "FileInput", "init", { name: c.name, accept: c.accept, multiple: c.multiple }), this.trigger("ready") } }; return b.FileInput = a }), a7(aN, [ae, a2], function (d, b) { function f(g, h) { switch (h) { case "readAsText": return b.atob(g, "utf8"); case "readAsBinaryString": return b.atob(g); case "readAsDataURL": return g } return null } var a = "", c = { read: function (i, g) { var h = this, j = h.getRuntime(); return "readAsDataURL" === i && (a = "data:" + (g.type || "") + ";base64,"), h.bind("Progress", function (e, k) { k && (a += f(k, i)) }), j.shimExec.call(this, "FileReader", "readAsBase64", g.uid) }, getResult: function () { return a }, destroy: function () { a = null } }; return d.FileReader = c }), a7(ar, [ae, a2], function (c, b) { function d(f, g) { switch (g) { case "readAsText": return b.atob(f, "utf8"); case "readAsBinaryString": return b.atob(f); case "readAsDataURL": return f } return null } var a = { read: function (j, g) { var f, h = this.getRuntime(); return (f = h.shimExec.call(this, "FileReaderSync", "readAsBase64", g.uid)) ? ("readAsDataURL" === j && (f = "data:" + (g.type || "") + ";base64," + f), d(f, j, g.type)) : null } }; return c.FileReaderSync = a }), a7(aa, [ae, aT, aP, aB, aF, ag, an, aw], function (g, k, d, f, b, c, h, l) { var j = { send: function (p, n) { function a() { p.transport = m.mode, m.shimExec.call(t, "XMLHttpRequest", "send", p, n) } function w(r, i) { m.shimExec.call(t, "XMLHttpRequest", "appendBlob", r, i.uid), n = null, a() } function v(r, i) { var s = new h; s.bind("TransportingComplete", function () { i(this.result) }), s.transport(r.getSource(), r.type, { ruid: m.uid }) } var t = this, m = t.getRuntime(); if (k.isEmptyObj(p.headers) || k.each(p.headers, function (r, i) { m.shimExec.call(t, "XMLHttpRequest", "setRequestHeader", i, r.toString()) }), n instanceof c) { var q; if (n.each(function (r, i) { r instanceof d ? q = i : m.shimExec.call(t, "XMLHttpRequest", "append", i, r) }), n.hasBlob()) { var o = n.getBlob(); o.isDetached() ? v(o, function (i) { o.destroy(), w(q, i) }) : w(q, o) } else { n = null, a() } } else { n instanceof d ? n.isDetached() ? v(n, function (i) { n.destroy(), n = i.uid, a() }) : (n = n.uid, a()) : a() } }, getResponse: function (p) { var r, q, i = this.getRuntime(); if (q = i.shimExec.call(this, "XMLHttpRequest", "getResponseAsBlob")) { if (q = new f(i.uid, q), "blob" === p) { return q } if (~k.inArray(p, ["", "text"])) { return r = new b, r.readAsText(q) } if ("arraybuffer" === p) { } else { if ("json" === p) { r = new b; try { return l(r.readAsText(q)) } catch (m) { return null } } } } return null }, abort: function (i) { var a = this.getRuntime(); a.shimExec.call(this, "XMLHttpRequest", "abort"), this.dispatchEvent("readystatechange"), this.dispatchEvent("abort") } }; return g.XMLHttpRequest = j }), a7(au, [ae, aP], function (b, a) { var c = { getAsBlob: function (f) { var g = this.getRuntime(), d = g.shimExec.call(this, "Transporter", "getAsBlob", f); return d ? new a(g.uid, d) : null } }; return b.Transporter = c }), a7(al, [ae, aT, an, aP, aF], function (d, b, g, a, c) { var f = { loadFromBlob: function (l) { function j(i) { k.shimExec.call(h, "Image", "loadFromBlob", i.uid), h = k = null } var h = this, k = h.getRuntime(); if (l.isDetached()) { var m = new g; m.bind("TransportingComplete", function () { j(m.result.getSource()) }), m.transport(l.getSource(), l.type, { ruid: k.uid }) } else { j(l.getSource()) } }, loadFromImage: function (i) { var h = this.getRuntime(); return h.shimExec.call(this, "Image", "loadFromImage", i.uid) }, getAsBlob: function (j, h) { var k = this.getRuntime(), i = k.shimExec.call(this, "Image", "getAsBlob", j, h); return i ? new a(k.uid, i) : null }, getAsDataURL: function () { var i = this.getRuntime(), h = i.Image.getAsBlob.apply(this, arguments), j; return h ? (j = new c, j.readAsDataURL(h)) : null } }; return d.Image = f }), a7(aY, [aT, bd, bb, aZ, a9], function (g, k, d, f, b) { function c(x) { var C = !1, q = null, w, m, p, A, D, B = 0; try { try { q = new ActiveXObject("AgControl.AgControl"), q.IsVersionSupported(x) && (C = !0), q = null } catch (z) { var v = navigator.plugins["Silverlight Plug-In"]; if (v) { for (w = v.description, "1.0.30226.2" === w && (w = "2.0.30226.2"), m = w.split(".") ; m.length > 3;) { m.pop() } for (; m.length < 4;) { m.push(0) } for (p = x.split(".") ; p.length > 4;) { p.pop() } do { A = parseInt(p[B], 10), D = parseInt(m[B], 10), B++ } while (B < p.length && A === D); D >= A && !isNaN(A) && (C = !0) } } } catch (y) { C = !1 } return C } function h(i) { var m = this, e; i = g.extend({ xap_url: k.xap_url }, i), b.call(this, i, l, { access_binary: b.capTrue, access_image_binary: b.capTrue, display_media: b.capTrue, do_cors: b.capTrue, drag_and_drop: !1, report_upload_progress: b.capTrue, resize_image: b.capTrue, return_response_headers: function (a) { return a && "client" === m.mode }, return_response_type: b.capTrue, return_status_code: function (a) { return "client" === m.mode || !g.arrayDiff(a, [200, 404]) }, select_file: b.capTrue, select_multiple: b.capTrue, send_binary_string: b.capTrue, send_browser_cookies: function (a) { return a && "browser" === m.mode }, send_custom_headers: function (a) { return a && "client" === m.mode }, send_multipart: b.capTrue, slice_blob: b.capTrue, stream_upload: !0, summon_file_dialog: !1, upload_filesize: b.capTrue, use_http_method: function (a) { return "client" === m.mode || !g.arrayDiff(a, ["GET", "POST"]) } }, { return_response_headers: function (a) { return a ? "client" : "browser" }, return_status_code: function (a) { return g.arrayDiff(a, [200, 404]) ? "client" : ["client", "browser"] }, send_browser_cookies: function (a) { return a ? "browser" : "client" }, send_custom_headers: function (a) { return a ? "client" : "browser" }, use_http_method: function (a) { return g.arrayDiff(a, ["GET", "POST"]) ? "client" : ["client", "browser"] } }), c("2.0.31005.0") && "Opera" !== k.browser || (this.mode = !1), g.extend(this, { getShim: function () { return d.get(this.uid).content.Moxie }, shimExec: function (o, a) { var p = [].slice.call(arguments, 2); return m.getShim().exec(this.uid, o, a, p) }, init: function () { var a; a = this.getShimContainer(), a.innerHTML = '<object id="' + this.uid + '" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="' + i.xap_url + '"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid=' + this.uid + ",target=" + k.global_event_dispatcher + '"/></object>', e = setTimeout(function () { m && !m.initialized && m.trigger("Error", new f.RuntimeError(f.RuntimeError.NOT_INIT_ERR)) }, "Windows" !== k.OS ? 10000 : 5000) }, destroy: function (a) { return function () { a.call(m), clearTimeout(e), i = e = a = m = null } }(this.destroy) }, j) } var l = "silverlight", j = {}; return b.addConstructor(l, h), j }), a7(ba, [aY, aT, ad], function (b, a, c) { return b.Blob = a.extend({}, c) }), a7(a5, [aY], function (b) { var a = { init: function (d) { function c(g) { for (var f = "", h = 0; h < g.length; h++) { f += ("" !== f ? "|" : "") + g[h].title + " | *." + g[h].extensions.replace(/,/g, ";*.") } return f } this.getRuntime().shimExec.call(this, "FileInput", "init", c(d.accept), d.name, d.multiple), this.trigger("ready") } }; return b.FileInput = a }), a7(aI, [aY, bb, ap], function (c, b, d) { var a = { init: function () { var h = this, f = h.getRuntime(), g; return g = f.getShimContainer(), d.addEvent(g, "dragover", function (i) { i.preventDefault(), i.stopPropagation(), i.dataTransfer.dropEffect = "copy" }, h.uid), d.addEvent(g, "dragenter", function (i) { i.preventDefault(); var j = b.get(f.uid).dragEnter(i); j && i.stopPropagation() }, h.uid), d.addEvent(g, "drop", function (i) { i.preventDefault(); var j = b.get(f.uid).dragDrop(i); j && i.stopPropagation() }, h.uid), f.shimExec.call(this, "FileDrop", "init") } }; return c.FileDrop = a }), a7(aL, [aY, aT, aN], function (b, a, c) { return b.FileReader = a.extend({}, c) }), a7(aK, [aY, aT, ar], function (b, a, c) { return b.FileReaderSync = a.extend({}, c) }), a7(ah, [aY, aT, aa], function (b, a, c) { return b.XMLHttpRequest = a.extend({}, c) }), a7(ay, [aY, aT, au], function (b, a, c) { return b.Transporter = a.extend({}, c) }), a7(aM, [aY, aT, al], function (b, a, c) { return b.Image = a.extend({}, c) }), a7(aG, [aT, aZ, a9, bd], function (g, d, j, c) { function f(e) { var k = this, i = j.capTest, a = j.capTrue; j.call(this, e, h, { access_binary: i(window.FileReader || window.File && File.getAsDataURL), access_image_binary: !1, display_media: i(b.Image && (c.can("create_canvas") || c.can("use_data_uri_over32kb"))), do_cors: !1, drag_and_drop: !1, filter_by_extension: i(function () { return "Chrome" === c.browser && c.version >= 28 || "IE" === c.browser && c.version >= 10 }()), resize_image: function () { return b.Image && k.can("access_binary") && c.can("create_canvas") }, report_upload_progress: !1, return_response_headers: !1, return_response_type: function (l) { return !!~g.inArray(l, ["json", "text", "document", ""]) }, return_status_code: function (l) { return !g.arrayDiff(l, [200, 404]) }, select_file: function () { return c.can("use_fileinput") }, select_multiple: !1, send_binary_string: !1, send_custom_headers: !1, send_multipart: !0, slice_blob: !1, stream_upload: function () { return k.can("select_file") }, summon_file_dialog: i(function () { return "Firefox" === c.browser && c.version >= 4 || "Opera" === c.browser && c.version >= 12 || "IE" === c.browser && c.version >= 10 || !!~g.inArray(c.browser, ["Chrome", "Safari"]) }()), upload_filesize: a, use_http_method: function (l) { return !g.arrayDiff(l, ["GET", "POST"]) } }), g.extend(this, { init: function () { this.trigger("Init") }, destroy: function (l) { return function () { l.call(k), l = k = null } }(this.destroy) }), g.extend(this.getShim(), b) } var h = "html4", b = {}; return j.addConstructor(h, f), b }), a7(aJ, [aG, aT, bb, ap, a3, bd], function (g, d, j, c, f, h) { function b() { function m() { var s = this, e = s.getRuntime(), v, t, u, o, a, q; q = d.guid("uid_"), v = e.getShimContainer(), i && (u = j.get(i + "_form"), u && d.extend(u.style, { top: "100%" })), o = document.createElement("form"), o.setAttribute("id", q + "_form"), o.setAttribute("method", "post"), o.setAttribute("enctype", "multipart/form-data"), o.setAttribute("encoding", "multipart/form-data"), d.extend(o.style, { overflow: "hidden", position: "absolute", top: 0, left: 0, width: "100%", height: "100%" }), a = document.createElement("input"), a.setAttribute("id", q), a.setAttribute("type", "file"), a.setAttribute("name", "Filedata"), a.setAttribute("accept", k.join(",")), d.extend(a.style, { fontSize: "999px", opacity: 0 }), o.appendChild(a), v.appendChild(o), d.extend(a.style, { position: "absolute", top: 0, left: 0, width: "100%", height: "100%" }), "IE" === h.browser && h.version < 10 && d.extend(a.style, { filter: "progid:DXImageTransform.Microsoft.Alpha(opacity=0)" }), a.onchange = function () { var p; this.value && (p = this.files ? this.files[0] : { name: this.value }, l = [p], this.onchange = function () { }, m.call(s), s.bind("change", function () { var x = j.get(q), w = j.get(q + "_form"), r; s.files.length && x && w && (r = s.files[0], x.setAttribute("id", r.uid), w.setAttribute("id", r.uid + "_form"), w.setAttribute("target", r.uid + "_iframe")), x = w = null }, 998), a = o = null, s.trigger("change")) }, e.can("summon_file_dialog") && (t = j.get(n.browse_button), c.removeEvent(t, "click", s.uid), c.addEvent(t, "click", function (p) { a && !a.disabled && a.click(), p.preventDefault() }, s.uid)), i = q, v = u = t = null, s.trigger({ type: "ready", async: !0 }) } var i, l = [], k = [], n; d.extend(this, { init: function (p) { var r = this, e = r.getRuntime(), q; n = p, k = p.accept.mimes || f.extList2mimes(p.accept, e.can("filter_by_extension")), q = e.getShimContainer(), function () { var s, o, a; s = j.get(p.browse_button), e.can("summon_file_dialog") && ("static" === j.getStyle(s, "position") && (s.style.position = "relative"), o = parseInt(j.getStyle(s, "z-index"), 10) || 1, s.style.zIndex = o, q.style.zIndex = o - 1), a = e.can("summon_file_dialog") ? s : q, c.addEvent(a, "mouseover", function () { r.trigger("mouseenter") }, r.uid), c.addEvent(a, "mouseout", function () { r.trigger("mouseleave") }, r.uid), c.addEvent(a, "mousedown", function () { r.trigger("mousedown") }, r.uid), c.addEvent(j.get(p.container), "mouseup", function () { r.trigger("mouseup") }, r.uid), s = null }(), m.call(this), q = null }, getFiles: function () { return l }, disable: function (o) { var a; (a = j.get(i)) && (a.disabled = !!o) }, destroy: function () { var o = this.getRuntime(), a = o.getShimContainer(); c.removeAllEvents(a, this.uid), c.removeAllEvents(n && j.get(n.container), this.uid), c.removeAllEvents(n && j.get(n.browse_button), this.uid), a && (a.innerHTML = ""), i = l = k = n = null } }) } return g.FileInput = b }), a7(ak, [aG, am], function (b, a) { return b.FileReader = a }), a7(aH, [aG, aT, bb, bf, aZ, ap, aP, ag, aw], function (h, m, f, g, b, d, k, p, l) { function j() { function i(z) { var w = this, v, y, c, x, q = !1; if (n) { if (v = n.id.replace(/_iframe$/, ""), y = f.get(v + "_form")) { for (c = y.getElementsByTagName("input"), x = c.length; x--;) { switch (c[x].getAttribute("type")) { case "hidden": c[x].parentNode.removeChild(c[x]); break; case "file": q = !0 } } c = [], q || y.parentNode.removeChild(y), y = null } setTimeout(function () { d.removeEvent(n, "load", w.uid), n.parentNode && n.parentNode.removeChild(n); var e = w.getRuntime().getShimContainer(); e.children.length || e.parentNode.removeChild(e), e = n = null, z() }, 1) } } var o, a, n; m.extend(this, { send: function (x, s) { function c() { var v = e.getShimContainer() || document.body, u = document.createElement("div"); u.innerHTML = '<iframe id="' + r + '_iframe" name="' + r + '_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>', n = u.firstChild, v.appendChild(n), d.addEvent(n, "load", function () { var A; try { A = n.contentWindow.document || n.contentDocument || window.frames[n.id].document, /^4\d{2}\s/.test(A.title) && A.getElementsByTagName("address").length ? o = A.title.replace(/^(\d+).*$/, "$1") : (o = 200, a = m.trim(A.body.innerHTML), q.trigger({ type: "progress", loaded: a.length, total: a.length }), z && q.trigger({ type: "uploadprogress", loaded: z.size || 1025, total: z.size || 1025 })) } catch (y) { if (!g.hasSameOrigin(x.url)) { return i.call(q, function () { q.trigger("error") }), void 0 } o = 404 } i.call(q, function () { q.trigger("load") }) }, q.uid) } var q = this, e = q.getRuntime(), r, w, t, z; if (o = a = null, s instanceof p && s.hasBlob()) { if (z = s.getBlob(), r = z.uid, t = f.get(r), w = f.get(r + "_form"), !w) { throw new b.DOMException(b.DOMException.NOT_FOUND_ERR) } } else { r = m.guid("uid_"), w = document.createElement("form"), w.setAttribute("id", r + "_form"), w.setAttribute("method", x.method), w.setAttribute("enctype", "multipart/form-data"), w.setAttribute("encoding", "multipart/form-data"), w.setAttribute("target", r + "_iframe"), e.getShimContainer().appendChild(w) } s instanceof p && s.each(function (v, y) { if (v instanceof k) { t && t.setAttribute("name", y) } else { var u = document.createElement("input"); m.extend(u, { type: "hidden", name: y, value: v }), w.appendChild(u) } }), w.setAttribute("action", x.url), c(), w.submit(), q.trigger("loadstart") }, getStatus: function () { return o }, getResponse: function (c) { if ("json" === c && "string" === m.typeOf(a)) { try { return l(a.replace(/^\s*<pre[^>]*>/, "").replace(/<\/pre>\s*$/, "")) } catch (q) { return null } } return a }, abort: function () { var c = this; n && n.contentWindow && (n.contentWindow.stop ? n.contentWindow.stop() : n.contentWindow.document.execCommand ? n.contentWindow.document.execCommand("Stop") : n.src = "about:blank"), i.call(this, function () { c.dispatchEvent("abort") }) } }) } return h.XMLHttpRequest = j }), a7(av, [aG, a6], function (b, a) { return b.Image = a }), bg([aT, be, a3, bd, bb, aZ, a8, a2, a9, aS, aP, aB, bh, aj, aR, aQ, bf, aF, ag, ai, an, aw, aC, ap]) }(this); (function () { var b = {}, a = moxie.core.utils.Basic.inArray; return function c(f) { var d, e; for (d in f) { e = typeof f[d], e === "object" && !~a(d, ["Exceptions", "Env", "Mime"]) ? c(f[d]) : e === "function" && (b[d] = f[d]) } }(window.moxie), b.Env = window.moxie.core.utils.Env, b.Mime = window.moxie.core.utils.Mime, b.Exceptions = window.moxie.core.Exceptions, window.mOxie = b, window.o || (window.o = b), b })(); (function (f, b, h) { function c(k) { function j(p, n, o) { var m = { chunks: "slice_blob", resize: "send_binary_string", jpgresize: "send_binary_string", pngresize: "send_binary_string", progress: "report_upload_progress", multi_selection: "select_multiple", max_file_size: "access_binary", dragdrop: "drag_and_drop", drop_element: "drag_and_drop", headers: "send_custom_headers", canSendBinary: "send_binary", triggerDialog: "summon_file_dialog" }; m[p] ? l[m[p]] = n : o || (l[p] = n) } var i = k.required_features, l = {}; return typeof i == "string" ? g.each(i.split(/\s*,\s*/), function (m) { j(m, !0) }) : typeof i == "object" ? g.each(i, function (n, m) { j(m, n) }) : i === !0 && (k.multipart || (l.send_binary_string = !0), k.chunk_size > 0 && (l.slice_blob = !0), g.each(k, function (n, m) { j(m, !!n, !0) })), l } var d = f.setTimeout, a = {}, g = { VERSION: "2.0.0beta", STOPPED: 1, STARTED: 2, QUEUED: 1, UPLOADING: 2, FAILED: 4, DONE: 5, GENERIC_ERROR: -100, HTTP_ERROR: -200, IO_ERROR: -300, SECURITY_ERROR: -400, INIT_ERROR: -500, FILE_SIZE_ERROR: -600, FILE_EXTENSION_ERROR: -601, FILE_DUPLICATE_ERROR: -602, IMAGE_FORMAT_ERROR: -700, IMAGE_MEMORY_ERROR: -701, IMAGE_DIMENSIONS_ERROR: -702, mimeTypes: b.mimes, ua: b.ua, typeOf: b.typeOf, extend: b.extend, guid: b.guid, each: b.each, getPos: b.getPos, getSize: b.getSize, xmlEncode: function (j) { var i = { "<": "lt", ">": "gt", "&": "amp", '"': "quot", "'": "#39" }, k = /[<>&\"\']/g; return j ? ("" + j).replace(k, function (l) { return i[l] ? "&" + i[l] + ";" : l }) : j }, toArray: b.toArray, inArray: b.inArray, addI18n: b.addI18n, translate: b.translate, isEmptyObj: b.isEmptyObj, hasClass: b.hasClass, addClass: b.addClass, removeClass: b.removeClass, getStyle: b.getStyle, addEvent: b.addEvent, removeEvent: b.removeEvent, removeAllEvents: b.removeAllEvents, cleanName: function (j) { var i, k; k = [/[\300-\306]/g, "A", /[\340-\346]/g, "a", /\307/g, "C", /\347/g, "c", /[\310-\313]/g, "E", /[\350-\353]/g, "e", /[\314-\317]/g, "I", /[\354-\357]/g, "i", /\321/g, "N", /\361/g, "n", /[\322-\330]/g, "O", /[\362-\370]/g, "o", /[\331-\334]/g, "U", /[\371-\374]/g, "u"]; for (i = 0; i < k.length; i += 2) { j = j.replace(k[i], k[i + 1]) } return j = j.replace(/\s+/g, "_"), j = j.replace(/[^a-z0-9_\-\.]+/gi, ""), j }, buildUrl: function (j, i) { var k = ""; return g.each(i, function (m, l) { k += (k ? "&" : "") + encodeURIComponent(l) + "=" + encodeURIComponent(m) }), k && (j += (j.indexOf("?") > 0 ? "&" : "?") + k), j }, formatSize: function (i) { return i === h || /\D/.test(i) ? g.translate("N/A") : i > 1099511627776 ? Math.round(i / 1099511627776, 1) + " " + g.translate("tb") : i > 1073741824 ? Math.round(i / 1073741824, 1) + " " + g.translate("gb") : i > 1048576 ? Math.round(i / 1048576, 1) + " " + g.translate("mb") : i > 1024 ? Math.round(i / 1024, 1) + " " + g.translate("kb") : i + " " + g.translate("b") }, parseSize: b.parseSizeStr, predictRuntime: function (k, i) { var l, j; return i && (k.runtimes = i), l = new g.Uploader(k), j = l.runtime, l.destroy(), j }, addFileFilter: function (j, i) { a[j] = i } }; g.addFileFilter("mime_types", function () { function k(m) { var l = []; return g.each(m, function (n) { g.each(n.extensions.split(/,/), function (o) { /^\s*\*\s*$/.test(o) ? l.push("\\.*") : l.push("\\." + o.replace(new RegExp("[" + "/^$.*+?|()[]{}\\".replace(/./g, "\\$&") + "]", "g"), "\\$&")) }) }), new RegExp("(" + l.join("|") + ")$", "i") } var j, i; return function (m, e, l) { if (!i || m != j) { i = k(m), j = [].slice.call(m) } i.test(e.name) ? l(!0) : (this.trigger("Error", { code: g.FILE_EXTENSION_ERROR, message: g.translate("File extension error."), file: e }), l(!1)) } }()), g.addFileFilter("max_file_size", function (k, i, l) { var j; i.size !== j && k && i.size > k ? (this.trigger("Error", { code: g.FILE_SIZE_ERROR, message: g.translate("File size error."), file: i }), l(!1)) : l(!0) }), g.addFileFilter("prevent_duplicates", function (k, i, l) { if (k) { var j = this.files.length; while (j--) { if (i.name === this.files[j].name && i.size === this.files[j].size) { this.trigger("Error", { code: g.FILE_DUPLICATE_ERROR, message: g.translate("Duplicate file error."), file: i }), l(!1); return } } } l(!0) }), g.Uploader = function (r) { function j() { var m, l = 0, p; if (this.state == g.STARTED) { for (p = 0; p < D.length; p++) { !m && D[p].status == g.QUEUED ? (m = D[p], this.trigger("BeforeUpload", m) && (m.status = g.UPLOADING, this.trigger("UploadFile", m))) : l++ } l == D.length && (this.state !== g.STOPPED && (this.state = g.STOPPED, this.trigger("StateChanged")), this.trigger("UploadComplete", D)) } } function o(l) { l.percent = l.size > 0 ? Math.ceil(l.loaded / l.size * 100) : 100, x() } function x() { var m, l; t.reset(); for (m = 0; m < D.length; m++) { l = D[m], l.size !== h ? (t.size += l.origSize, t.loaded += l.loaded * l.origSize / l.size) : t.size = h, l.status == g.DONE ? t.uploaded++ : l.status == g.FAILED ? t.failed++ : t.queued++ } t.size === h ? t.percent = D.length > 0 ? Math.ceil(t.uploaded / D.length * 100) : 0 : (t.bytesPerSec = Math.ceil(t.loaded / ((+(new Date) - k || 1) / 1000)), t.percent = t.size > 0 ? Math.ceil(t.loaded / t.size * 100) : 0) } function z() { var m = this, l = 0, e = { accept: r.filters.mime_types, runtime_order: r.runtimes, required_caps: q, swf_url: r.flash_swf_url, xap_url: r.silverlight_xap_url }; g.each(r.runtimes.split(/\s*,\s*/), function (p) { r[p] && (e[p] = r[p]) }), b.inSeries([function (p) { r.browse_button ? (i = new b.FileInput(g.extend({}, e, { name: r.file_data_name, multiple: r.multi_selection, container: r.container, browse_button: r.browse_button })), i.onready = function () { var u = b.Runtime.getInfo(this.ruid); b.extend(m.features, { chunks: u.can("slice_blob"), multipart: u.can("send_multipart"), multi_selection: u.can("select_multiple") }), l++, p() }, i.onchange = function () { m.addFile(this.files) }, i.bind("mouseenter mouseleave mousedown mouseup", function (v) { if (!n) { var u = b.get(r.browse_button); u && (r.browse_button_hover && ("mouseenter" === v.type ? b.addClass(u, r.browse_button_hover) : "mouseleave" === v.type && b.removeClass(u, r.browse_button_hover)), r.browse_button_active && ("mousedown" === v.type ? b.addClass(u, r.browse_button_active) : "mouseup" === v.type && b.removeClass(u, r.browse_button_active)), u = null) } }), i.bind("error runtimeerror", function () { i = null, p() }), i.init()) : p() }, function (p) { r.drop_element ? (s = new b.FileDrop(g.extend({}, e, { drop_zone: r.drop_element })), s.onready = function () { var u = b.Runtime.getInfo(this.ruid); m.features.dragdrop = u.can("drag_and_drop"), l++, p() }, s.ondrop = function () { m.addFile(this.files) }, s.bind("error runtimeerror", function () { s = null, p() }), s.init()) : p() }], function () { typeof r.init == "function" ? r.init(m) : g.each(r.init, function (u, p) { m.bind(p, u) }), l ? m.trigger("PostInit") : m.trigger("Error", { code: g.INIT_ERROR, message: g.translate("Init error.") }) }) } function B(m, p) { if (m.ruid) { var l = b.Runtime.getInfo(m.ruid); if (l) { return l.can(p) } } return !1 } function F(u, v, p) { var l = new b.Image; try { l.onload = function () { l.downsize(v.width, v.height, v.crop, v.preserve_headers) }, l.onresize = function () { p(this.getAsBlob(u.type, v.quality)), this.destroy() }, l.onerror = function () { p(u) }, l.load(u) } catch (m) { p(u) } } var D = [], A = {}, q = {}, k, t, n = !1, i, s, C; t = new g.QueueProgress, r = g.extend({ runtimes: b.Runtime.order, max_retries: 0, multipart: !0, multi_selection: !0, file_data_name: "file", flash_swf_url: "js/Moxie.swf", silverlight_xap_url: "js/Moxie.xap", send_chunk_number: !0 }, r), r.resize && (r.resize = g.extend({ preserve_headers: !0, crop: !1 }, r.resize)), g.typeOf(r.filters) === "array" && (r.filters = { mime_types: r.filters }), r.filters = g.extend({ mime_types: [], prevent_duplicates: !!r.prevent_duplicates, max_file_size: r.max_file_size }, r.filters), r.filters.max_file_size = g.parseSize(r.filters.max_file_size) || 0, r.chunk_size = g.parseSize(r.chunk_size) || 0, r.required_features = q = c(g.extend({}, r)), g.extend(this, { id: g.guid(), state: g.STOPPED, features: {}, runtime: b.Runtime.thatCan(q, r.runtimes), files: D, settings: r, total: t, init: function () { var e = this; r.browse_button = b.get(r.browse_button), r.drop_element = b.get(r.drop_element), typeof r.preinit == "function" ? r.preinit(e) : g.each(r.preinit, function (m, l) { e.bind(l, m) }); if (!r.browse_button || !r.url) { this.trigger("Error", { code: g.INIT_ERROR, message: g.translate("Init error.") }); return } e.bind("FilesAdded", function (m, l) { [].push.apply(D, l), d(function () { e.trigger("QueueChanged"), e.refresh() }, 1) }), e.bind("CancelUpload", function () { C && C.abort() }), r.unique_names && e.bind("BeforeUpload", function (p, l) { var u = l.name.match(/\.([^.]+)$/), m = "part"; u && (m = u[1]), l.target_name = l.id + "." + m }), e.bind("UploadFile", function (v, y) { function m() { w-- > 0 ? d(G, 1) : (y.loaded = E, v.trigger("Error", { code: g.HTTP_ERROR, message: g.translate("HTTP Error."), file: y, response: C.responseText, status: C.status, responseHeaders: C.getAllResponseHeaders() })) } function G() { var u, p, L, M; if (y.status == g.DONE || y.status == g.FAILED || v.state == g.STOPPED) { return } L = { name: y.target_name || y.name }, I && J.chunks && H.size > I ? (M = Math.min(I, H.size - E), u = H.slice(E, E + M)) : (M = H.size, u = H), I && J.chunks && (r.send_chunk_number ? (L.chunk = Math.ceil(E / I), L.chunks = Math.ceil(H.size / I)) : (L.offset = E, L.total = H.size)), C = new b.XMLHttpRequest, C.upload && (C.upload.onprogress = function (l) { y.loaded = Math.min(y.size, E + l.loaded), v.trigger("UploadProgress", y) }), C.onload = function () { if (C.status >= 400) { m(); return } M < H.size ? (u.destroy(), E += M, y.loaded = Math.min(E, H.size), v.trigger("ChunkUploaded", y, { offset: y.loaded, total: H.size, response: C.responseText, status: C.status, responseHeaders: C.getAllResponseHeaders() }), b.Env.browser === "Android Browser" && v.trigger("UploadProgress", y)) : y.loaded = y.size, u = p = null, !E || E >= H.size ? (y.size != y.origSize && (H.destroy(), H = null), v.trigger("UploadProgress", y), y.status = g.DONE, v.trigger("FileUploaded", y, { response: C.responseText, status: C.status, responseHeaders: C.getAllResponseHeaders() })) : d(G, 1) }, C.onerror = function () { m() }, C.onloadend = function () { this.destroy(), C = null }, v.settings.multipart && J.multipart ? (L.name = y.target_name || y.name, C.open("post", K, !0), g.each(v.settings.headers, function (N, l) { C.setRequestHeader(l, N) }), p = new b.FormData, g.each(g.extend(L, v.settings.multipart_params), function (N, l) { p.append(l, N) }), p.append(v.settings.file_data_name, u), C.send(p, { runtime_order: v.settings.runtimes, required_caps: q, swf_url: v.settings.flash_swf_url, xap_url: v.settings.silverlight_xap_url })) : (K = g.buildUrl(v.settings.url, g.extend(L, v.settings.multipart_params)), C.open("post", K, !0), C.setRequestHeader("Content-Type", "application/octet-stream"), g.each(v.settings.headers, function (N, l) { C.setRequestHeader(l, N) }), C.send(u, { runtime_order: v.settings.runtimes, required_caps: q, swf_url: v.settings.flash_swf_url, xap_url: v.settings.silverlight_xap_url })) } var K = v.settings.url, J = v.features, I = r.chunk_size, w = r.max_retries, H, E = 0; y.loaded && (E = y.loaded = I * Math.floor(y.loaded / I)), H = y.getSource(), !b.isEmptyObj(v.settings.resize) && B(H, "send_binary_string") && !!~b.inArray(H.type, ["image/jpeg", "image/png"]) ? F.call(this, H, v.settings.resize, function (l) { H = l, y.size = l.size, G() }) : G() }), e.bind("UploadProgress", function (m, l) { o(l) }), e.bind("StateChanged", function (m) { if (m.state == g.STARTED) { k = +(new Date) } else { if (m.state == g.STOPPED) { for (var l = m.files.length - 1; l >= 0; l--) { m.files[l].status == g.UPLOADING && (m.files[l].status = g.QUEUED, x()) } } } }), e.bind("QueueChanged", x), e.bind("Error", function (m, l) { l.file && (l.file.status = g.FAILED, o(l.file), m.state == g.STARTED && d(function () { j.call(e) }, 1)) }), e.bind("FileUploaded", function () { x(), d(function () { j.call(e) }, 1) }), e.trigger("Init", { runtime: this.runtime }), z.call(this) }, refresh: function () { i && i.trigger("Refresh"), this.trigger("Refresh") }, start: function () { this.state != g.STARTED && (this.state = g.STARTED, this.trigger("StateChanged"), j.call(this)) }, stop: function () { this.state != g.STOPPED && (this.state = g.STOPPED, this.trigger("StateChanged"), this.trigger("CancelUpload")) }, disableBrowse: function () { n = arguments[0] !== h ? arguments[0] : !0, i && i.disable(n), this.trigger("DisableBrowse", n) }, getFile: function (m) { var l; for (l = D.length - 1; l >= 0; l--) { if (D[l].id === m) { return D[l] } } }, addFile: function (y, p) { function w() { var l = s || i; return l ? l.getRuntime().uid : !1 } function v(u, J) { var l = []; b.each(m.settings.filters, function (e, K) { a[K] && l.push(function (L) { a[K].call(m, e, u, function (M) { L(!M) }) }) }), b.inSeries(l, J) } function E(u) { var l = b.typeOf(u); if (u instanceof b.File) { if (!u.ruid && !u.isDetached()) { if (!G) { return !1 } u.ruid = G, u.connectRuntime(G) } E(new g.File(u)) } else { u instanceof b.Blob ? (E(u.getSource()), u.destroy()) : u instanceof g.File ? (p && (u.name = p), I.push(function (e) { v(u, function (J) { J || H.push(u), e() }) })) : b.inArray(l, ["file", "blob"]) !== -1 ? E(new b.File(null, u)) : l === "node" && b.typeOf(u.files) === "filelist" ? b.each(u.files, E) : l === "array" && (p = null, b.each(u, E)) } } var m = this, I = [], H = [], G; G = w(), E(y), I.length && b.inSeries(I, function () { H.length && m.trigger("FilesAdded", H) }) }, removeFile: function (m) { var l = typeof m == "string" ? m : m.id; for (var p = D.length - 1; p >= 0; p--) { if (D[p].id === l) { return this.splice(p, 1)[0] } } }, splice: function (p, l) { var m = D.splice(p === h ? 0 : p, l === h ? D.length : l); return this.trigger("FilesRemoved", m), this.trigger("QueueChanged"), g.each(m, function (u) { u.destroy() }), m }, trigger: function (p) { var l = A[p.toLowerCase()], u, m; if (l) { m = Array.prototype.slice.call(arguments), m[0] = this; for (u = 0; u < l.length; u++) { if (l[u].func.apply(l[u].scope, m) === !1) { return !1 } } } return !0 }, hasEventListener: function (l) { return !!A[l.toLowerCase()] }, bind: function (p, l, u) { var m; p = p.toLowerCase(), m = A[p] || [], m.push({ func: l, scope: u || this }), A[p] = m }, unbind: function (u) { u = u.toLowerCase(); var m = A[u], p, l = arguments[1]; if (m) { if (l !== h) { for (p = m.length - 1; p >= 0; p--) { if (m[p].func === l) { m.splice(p, 1); break } } } else { m = [] } m.length || delete A[u] } }, unbindAll: function () { var l = this; g.each(A, function (e, m) { l.unbind(m) }) }, destroy: function () { this.stop(), g.each(D, function (l) { l.destroy() }), D = [], i && (i.destroy(), i = null), s && (s.destroy(), s = null), q = {}, k = t = n = C = null, this.trigger("Destroy"), this.unbindAll(), A = {} } }) }, g.File = function () { function j(e) { g.extend(this, { id: g.guid(), name: e.name || e.fileName, type: e.type || "", size: e.size || e.fileSize, origSize: e.size || e.fileSize, loaded: 0, percent: 0, status: g.QUEUED, lastModifiedDate: e.lastModifiedDate || (new Date).toLocaleString(), getNative: function () { var k = this.getSource().getSource(); return b.inArray(b.typeOf(k), ["blob", "file"]) !== -1 ? k : null }, getSource: function () { return i[this.id] ? i[this.id] : null }, destroy: function () { var k = this.getSource(); k && (k.destroy(), delete i[this.id]) } }), i[this.id] = e } var i = {}; return j }(), g.QueueProgress = function () { var i = this; i.size = 0, i.loaded = 0, i.uploaded = 0, i.failed = 0, i.queued = 0, i.percent = 0, i.bytesPerSec = 0, i.reset = function () { i.size = i.loaded = i.uploaded = i.failed = i.queued = i.percent = i.bytesPerSec = 0 } }, f.plupload = g })(window, mOxie);