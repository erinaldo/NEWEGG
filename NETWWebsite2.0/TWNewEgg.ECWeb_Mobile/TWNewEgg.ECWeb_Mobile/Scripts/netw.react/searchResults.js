!function(e){function t(s){if(r[s])return r[s].exports;var a=r[s]={exports:{},id:s,loaded:!1};return e[s].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}({0:function(e,t,r){e.exports=r(114)},50:function(e,t){"use strict";var r=React.createClass({displayName:"Loading",loadStyle:function(){var e={height:"60px"};return"number"==typeof this.props.height&&(e.height=this.props.height+"px"),e},showContent:function(){var e=React.createElement("div",{className:"load"},React.createElement("span",null,"Loading..."));return"string"==typeof this.props.content&&(e=this.props.content),e},render:function(){return React.createElement("div",{style:this.loadStyle()},this.showContent())}});e.exports=r},114:function(e,t,r){"use strict";var s=r(115),a=function(){ReactDOM.render(React.createElement(s,null),document.getElementById("content"))};window.nemReact.reacts.searchResults={init:a}},115:function(e,t,r){"use strict";function s(e,t,r,s){var a=h.getSearchItems();return null!=a&&0!==a.length||i.getSearchItems(e,t,r,s),{searchItems:a}}var a=nemReact.require("NEProduct","react"),n=nemReact.require("NetwTools"),o=r(116),c=r(50),i=nemReact.require("SearchAction"),h=nemReact.require("SearchStore"),d=[{orderMenu:"6",orderName:"最新上架"},{orderMenu:"3",orderName:"人氣排行榜"},{orderMenu:"2",orderName:"推薦排行"},{orderMenu:"0",orderName:"金額高"},{orderMenu:"1",orderName:"金額低"}],l=React.createClass({displayName:"SrchInInputBar",handleChange:function(e){this.setState({srchIn:e.target.value})},getInitialState:function(){return{searchWord:this.props.searchWord,srchIn:this.props.srchIn}},componentWillReceiveProps:function(e){this.setState({searchWord:e.searchWord,srchIn:e.srchIn})},render:function(){return React.createElement("div",{className:"searchAgain"},React.createElement("input",{type:"text",placeholder:"請輸入商品關鍵字",value:this.state.srchIn,onChange:this.handleChange}),React.createElement("a",{href:"",className:"remove",onClick:this._clearSrchIn},React.createElement("span",null,"清除")),React.createElement("button",{type:"button",name:"button",onClick:this._goSrchIn},"搜尋"))},_clearSrchIn:function(e){if(e.preventDefault(),this.state.srchIn){var t="";this.setState({srchIn:t}),this.props.setSrchIn(t)}},_goSrchIn:function(){this.state.srchIn&&this.props.setSrchIn(this.state.srchIn)}}),u=React.createClass({displayName:"SearchResultsContent",setSrchIn:function(e){var t="searchword="+this.state.searchWord+"&order="+this.state.order+"&srchin="+e;history.pushState({searchWord:this.state.searchWord,order:this.state.order,srchIn:e},"","?"+t),this.setState({srchIn:e,pageNumber:0,searchItems:[],isLoad:!0});var r=this;setTimeout(function(){i.getSearchItems(r.state.searchWord,r.state.order,r.state.pageNumber,e)},200)},setOrder:function(e){var t="searchword="+this.state.searchWord+"&order="+e+"&srchin="+this.state.srchIn;history.pushState({searchWord:this.state.searchWord,order:e,srchIn:this.state.srchIn},"","?"+t),this.setState({order:e,pageNumber:0,searchItems:[],isLoad:!0}),setTimeout(function(){i.getSearchItems(this.state.searchWord,e,this.state.pageNumber,this.state.srchIn)}.bind(this),200)},handleScroll:function(e){var t=$("#searchResults").height(),r=window.innerHeight,s=$(window).scrollTop(),a=s+r;if(a+100>t)if(!this.state.isLoad&&h.getHasData()){this.setState({isLoad:!0});var n=h.getSearchMaxPage(),o=++this.state.pageNumber;n>=o?i.getSearchItems(this.state.searchWord,this.state.order,this.state.pageNumber,this.state.srchIn):this.setState({isLoad:!1})}else this.setState({isLoad:!1})},handleOnPopState:function(e){if(e.state)this.setState({searchWord:e.state.searchWord,order:e.state.order,pageNumber:0,srchIn:e.state.srchIn,isLoad:!0}),setTimeout(function(){i.getSearchItems(this.state.searchWord,this.state.order,0,this.state.srchIn)}.bind(this),200);else{var t=n.parseUrlFormatByNameIC(location.search,"order");t||(t="2");var r=n.parseUrlFormatByNameIC(location.search,"searchword"),s=n.parseUrlFormatByNameIC(location.search,"srchin");this.setState({searchWord:r,order:t,pageNumber:0,srchIn:s,isLoad:!0}),setTimeout(function(){i.getSearchItems(this.state.searchWord,this.state.order,0,this.state.srchIn)}.bind(this),200)}},showLoad:function(){return this.state.isLoad?React.createElement(c,null):null},generateNEProd:function(){for(var e=[],t=0;t<this.state.searchItems.length;t++){var r=React.createElement(a,{productID:this.state.searchItems[t].ID,imgUrl:this.state.searchItems[t].PhotoName,productLink:"",title:this.state.searchItems[t].Name,qty:this.state.searchItems[t].SellingQty,marketPrice:0,sellingPrice:this.state.searchItems[t].Pricecash});e.push(r)}return e},componentWillMount:function(){window.addEventListener("scroll",this.handleScroll),window.addEventListener("popstate",this.handleOnPopState),this.setState(s(this.state.searchWord,this.state.order,this.state.pageNumber,this.state.srchIn))},componentDidMount:function(){h.addChangeListener(this._onChange)},componentWillUnmount:function(){h.removeChangeListener(this._onChange),window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("popstate",this.handleOnPopState)},getInitialState:function(){var e=n.parseUrlFormatByNameIC(location.search,"order");return e||(e="2"),{searchWord:n.parseUrlFormatByNameIC(location.search,"searchword"),srchIn:n.parseUrlFormatByNameIC(location.search,"srchin"),order:e,pageNumber:0,totalNum:0,isLoad:!0,searchItems:[]}},render:function(){return React.createElement("div",{className:"searchResults",id:"searchResults"},React.createElement("div",{className:"searchBar"},React.createElement("div",{className:"sRsText"},React.createElement("p",null,"搜尋結果:"),React.createElement("p",null,this.state.searchWord),React.createElement("p",null,"(共",this.state.totalNum,"筆)")),React.createElement(l,{searchWord:this.state.searchWord,srchIn:this.state.srchIn,setSrchIn:this.setSrchIn})),React.createElement("div",{className:"searchResultsContent"},React.createElement(o,{noProductWords:"無搜尋結果，請嘗試其他關鍵字",productLists:this.generateNEProd(),prodListKey:this.state.searchWord+this.state.srchIn+this.state.order,orderList:d,orderMenu:this.state.order,setOrder:this.setOrder,isLoad:this.state.isLoad})),this.showLoad())},_onChange:function(){this.setState({isLoad:!1,totalNum:h.getSearchTotalNum()}),h.getHasData()&&this.setState(s(this.state.searchWord,this.state.order,this.state.pageNumber,this.state.srchIn))}});e.exports=u},116:function(e,t){"use strict";var r=[{orderMenu:"newArrival",orderName:"最新上架"},{orderMenu:"popularity",orderName:"人氣排行榜"},{orderMenu:"recommended",orderName:"推薦排行"},{orderMenu:"highPrice",orderName:"金額高"},{orderMenu:"lowPrice",orderName:"金額低"}],s=React.createClass({displayName:"ProductInLi",render:function(){return React.createElement("li",null,this.props.product)}}),a=React.createClass({displayName:"SelectFrameProds",setProdStyle:function(e){this.setState({fullProdStyle:e})},showProducts:function(){var e=[];if("undefined"==typeof this.state.productLists||0==this.state.productLists.length&&!this.state.isLoad){var t=React.createElement("div",{key:"noProducts"},this.state.noProductWords);return e.push(t),e}for(var r=0;r<this.state.productLists.length;r++){var t=React.createElement(s,{key:r,product:this.state.productLists[r]});e.push(t)}return e},propTypes:{productLists:React.PropTypes.array,noProductWords:React.PropTypes.string,orderList:React.PropTypes.array.isRequired},handleSelectOrder:function(e){this.setState({currentOrderMenu:e.target.value}),setTimeout(function(){this.props.setOrder(this.state.currentOrderMenu)}.bind(this),200)},getInitialState:function(){return{orderSelect:r,currentOrderMenu:r[0].orderMenu,fullProdStyle:!1,productLists:this.props.productLists,noProductWords:this.props.noProductWords,isLoad:this.props.isLoad}},componentWillMount:function(){this.setState({orderSelect:this.props.orderList,currentOrderMenu:this.props.orderMenu})},componentWillReceiveProps:function(e){this.setState({productLists:e.productLists,noProductWords:e.noProductWords,currentOrderMenu:e.orderMenu,isLoad:e.isLoad})},componentDidMount:function(){},render:function(){return React.createElement("div",{className:"SelectFramePage"},React.createElement("div",{className:"selectFrame"},React.createElement("p",{className:"selectWrap noLabel"},React.createElement("select",{value:this.state.currentOrderMenu,onChange:this.handleSelectOrder},this.state.orderSelect.map(function(e,t){return React.createElement("option",{key:t,value:e.orderMenu},e.orderName)},this))),React.createElement("p",{className:"frameTwo fa "+(this.state.fullProdStyle?"frameColor":""),onClick:this.setProdStyle.bind(this,!0)}),React.createElement("p",{className:"frameOne fa "+(this.state.fullProdStyle?"":"frameColor"),onClick:this.setProdStyle.bind(this,!1)})),React.createElement("div",{className:"subprodLists frameList"},React.createElement("ul",{className:"prodLists "+(this.state.fullProdStyle?"full":""),key:this.props.prodListKey},this.showProducts())))}});e.exports=a}});